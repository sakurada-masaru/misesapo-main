@layout('layouts.base')
@json('data/meta/service_title.json', $title)
@json('data/meta/service_body_class.json', $body_class)
@json('data/meta/service_meta.json', $meta)

<!-- Splash Screen -->
<div id="splash-screen" class="splash-screen">
  <img src="/images/logo_144x144.png" alt="ミセサポ" class="splash-logo" />
</div>

<!-- Main Content -->
<div id="page-content">
<!-- Hero (full-bleed) -->
<section class="hero">
  <img class="hero-img"
       src="/images/header-main.png"
       srcset="/images/hero-1200x400.svg 1200w, /images/header-main.png 1600w"
       sizes="100vw"
       alt="ミセサポ ヒーロー" />
  <div class="hero-overlay" aria-hidden="true"></div>
  <button class="carousel-btn left" aria-label="前へ">
    <i class="fas fa-chevron-left"></i>
  </button>
  <button class="carousel-btn right" aria-label="次へ">
    <i class="fas fa-chevron-right"></i>
  </button>
</section>

<!-- Category Tabs just below Hero -->
<section class="container section-gap-lg">
  <div class="tabs-row">
    <div class="tabs">
      <button class="tab active" data-category="all">全て</button>
      <button class="tab" data-category="厨房設備">厨房設備</button>
      <button class="tab" data-category="空調設備">空調設備</button>
      <button class="tab" data-category="フロア">フロア</button>
      <button class="tab" data-category="その他">その他</button>
    </div>
  </div>
  </section>

<!-- Main Content -->
<!-- Cart and Categories -->
<section class="container section-gap-lg">
  <div class="cart-row">
    <a class="btn btn-primary cart-button" href="/cart">
      <i class="fas fa-shopping-cart"></i>
      <span>カートを見る</span>
      <span class="cart-badge">0</span>
    </a>
  </div>

  <p class="muted text-center small">
    ※料金は目安となります。店舗の広さや業態、建物の状況により金額が前後する場合がございます。<br />
    クリックすると詳細入力画面が表示されます。
  </p>

  <!-- Services Grid -->
  @json('data/service_items.json', $service_items)
  <div class="service-grid">
    <!-- Service Items (generated) -->
    @foreach $service_items
    <article class="card-service" data-id="{{ id }}" data-category="{{ category }}">
      <a href="/service/{{ id }}" class="card-service-link">
        <div class="thumb">
          <img src="{{ image }}" alt="{{ title }}" loading="lazy" decoding="async" />
        </div>
        <div class="content">
          <h3>{{ title }}</h3>
          <p class="price">{{ price }}</p>
        </div>
      </a>
    </article>
    @endforeach
  </div>
</section>

@include('partials.service_item_modal')
@include('partials.details_modal')
@include('partials.order_modal')
@include('partials.cart_added_modal')
<script>
  window.SERVICE_ITEMS = @jsonvar $service_items;
  // body_class と title は JSON で供給
</script>

<style>
  /* サービスページのヒーローセクションを全画面表示 */
  body.page-service .hero {
    position: relative;
    width: 100vw;
    height: 100vh;
    min-height: 600px;
    margin-left: calc(50% - 50vw);
    margin-right: calc(50% - 50vw);
    margin-top: 0;
    margin-bottom: 0;
    padding: 0;
    overflow: hidden;
  }
  
  body.page-service .hero-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    max-width: none;
    margin: 0;
  }
  
  body.page-service .hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.2);
    z-index: 1;
  }
  
  body.page-service .carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 2;
    background: rgba(255, 255, 255, 0.8);
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: #333;
    transition: background 0.3s;
  }
  
  body.page-service .carousel-btn:hover {
    background: rgba(255, 255, 255, 1);
  }
  
  body.page-service .carousel-btn.left {
    left: 20px;
  }
  
  body.page-service .carousel-btn.right {
    right: 20px;
  }
  
  @media (max-width: 768px) {
    body.page-service .hero {
      height: 50vh;
      min-height: 400px;
    }
    
    body.page-service .carousel-btn {
      width: 40px;
      height: 40px;
      font-size: 1rem;
    }
    
    body.page-service .carousel-btn.left {
      left: 10px;
    }
    
    body.page-service .carousel-btn.right {
      right: 10px;
    }
  }
</style>
</div>
<!-- End of page-content -->

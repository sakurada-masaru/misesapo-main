@layout('layouts.base')
@json('data/meta/sales_store_chart_title.json', $title)
@json('data/meta/sales_store_chart_body_class.json', $body_class)

<link rel="stylesheet" href="/css/sales-store-chart.css" />
<script src="/js/data_utils.js"></script>

<main id="main" class="container sales-store-chart">
  <div class="page-header">
    <a href="/sales/clients" class="back-btn">
      <i class="fas fa-chevron-left"></i>
    </a>
    <h1 class="page-title">清掃カルテ（簡易版）</h1>
    <div class="header-actions">
      <button type="button" class="btn btn-secondary btn-sm" id="print-chart-btn" style="display: none;">
        <i class="fas fa-print"></i> 印刷
      </button>
      <button type="button" class="btn btn-primary btn-sm" id="save-chart-btn">
        <i class="fas fa-save"></i> 保存
      </button>
    </div>
  </div>

  <!-- 基本情報セクション -->
  <section class="chart-section" id="basic-info-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-info-circle"></i>
        基本情報
      </h2>
    </div>
    <div class="section-content">
      <div class="info-card">
        <div class="info-row">
          <span class="info-label">店舗名</span>
          <span class="info-value" id="store-name">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">ブランド名</span>
          <span class="info-value" id="brand-name">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">法人名</span>
          <span class="info-value" id="client-name">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">住所</span>
          <span class="info-value" id="store-address">-</span>
        </div>
        <div class="info-row">
          <span class="info-label">電話番号</span>
          <span class="info-value" id="store-phone">-</span>
        </div>
      </div>
    </div>
  </section>

  <!-- 設備セクション -->
  <section class="chart-section" id="equipment-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-tools"></i>
        設備
      </h2>
      <button type="button" class="section-toggle" aria-label="セクションを開閉">
        <i class="fas fa-chevron-down"></i>
      </button>
    </div>
    <div class="section-content">
      <div class="equipment-categories">
        <!-- 厨房設備 -->
        <div class="equipment-category">
          <h3 class="category-title">厨房設備</h3>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="グリストラップ">
              <span class="checkbox-label">グリストラップ</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="換気扇">
              <span class="checkbox-label">換気扇</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="厨房機器">
              <span class="checkbox-label">厨房機器</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="シンク">
              <span class="checkbox-label">シンク</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="U字溝">
              <span class="checkbox-label">U字溝・グレーチング</span>
            </label>
          </div>
        </div>

        <!-- 空調設備 -->
        <div class="equipment-category">
          <h3 class="category-title">空調設備</h3>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="エアコン">
              <span class="checkbox-label">エアコン</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="空調ダクト">
              <span class="checkbox-label">空調ダクト</span>
            </label>
          </div>
        </div>

        <!-- 床・壁 -->
        <div class="equipment-category">
          <h3 class="category-title">床・壁</h3>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="床">
              <span class="checkbox-label">床</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="壁">
              <span class="checkbox-label">壁</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="天井">
              <span class="checkbox-label">天井</span>
            </label>
          </div>
        </div>

        <!-- その他 -->
        <div class="equipment-category">
          <h3 class="category-title">その他</h3>
          <div class="checkbox-group">
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="トイレ">
              <span class="checkbox-label">トイレ</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="洗面所">
              <span class="checkbox-label">洗面所</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="窓">
              <span class="checkbox-label">窓</span>
            </label>
            <label class="checkbox-item">
              <input type="checkbox" name="equipment" value="カーペット">
              <span class="checkbox-label">カーペット</span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- サービス内容セクション -->
  <section class="chart-section" id="services-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-list-check"></i>
        サービス内容
      </h2>
      <button type="button" class="section-toggle" aria-label="セクションを開閉">
        <i class="fas fa-chevron-down"></i>
      </button>
    </div>
    <div class="section-content">
      <div class="services-list" id="services-list">
        <div class="loading">読み込み中...</div>
      </div>
    </div>
  </section>

  <!-- 消耗品セクション（簡易版では非表示） -->
  <section class="chart-section chart-section-complete-only" id="consumables-section" style="display: none;">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-box"></i>
        使用消耗品
      </h2>
      <button type="button" class="section-toggle" aria-label="セクションを開閉">
        <i class="fas fa-chevron-down"></i>
      </button>
    </div>
    <div class="section-content">
      <div class="consumables-list" id="consumables-list">
        <div class="empty-state">消耗品が登録されていません</div>
      </div>
      <button type="button" class="btn btn-outline btn-sm" id="add-consumable-btn">
        <i class="fas fa-plus"></i> 消耗品を追加
      </button>
    </div>
  </section>

  <!-- 清掃担当者履歴セクション（簡易版では非表示） -->
  <section class="chart-section chart-section-complete-only" id="staff-history-section" style="display: none;">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-users"></i>
        清掃担当者履歴
      </h2>
      <button type="button" class="section-toggle" aria-label="セクションを開閉">
        <i class="fas fa-chevron-down"></i>
      </button>
    </div>
    <div class="section-content">
      <div class="staff-history-list" id="staff-history-list">
        <div class="empty-state">担当者履歴がありません</div>
      </div>
      <button type="button" class="btn btn-outline btn-sm" id="add-staff-btn">
        <i class="fas fa-plus"></i> 担当者を追加
      </button>
    </div>
  </section>

  <!-- メモセクション -->
  <section class="chart-section" id="notes-section">
    <div class="section-header">
      <h2 class="section-title">
        <i class="fas fa-sticky-note"></i>
        メモ・特記事項
      </h2>
      <button type="button" class="section-toggle" aria-label="セクションを開閉">
        <i class="fas fa-chevron-down"></i>
      </button>
    </div>
    <div class="section-content">
      <textarea id="chart-notes" rows="6" placeholder="特記事項や注意点を入力してください"></textarea>
    </div>
  </section>
</main>

<!-- 消耗品追加モーダル -->
<dialog id="consumable-modal" class="chart-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>消耗品を追加</h3>
      <button type="button" class="modal-close" onclick="document.getElementById('consumable-modal').close()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="consumable-name">消耗品名 <span class="required">*</span></label>
        <input type="text" id="consumable-name" placeholder="例: 洗剤A" required>
      </div>
      <div class="form-group">
        <label for="consumable-quantity">数量</label>
        <input type="text" id="consumable-quantity" placeholder="例: 500ml">
      </div>
      <div class="form-group">
        <label for="consumable-notes">備考</label>
        <textarea id="consumable-notes" rows="3" placeholder="使用場所や注意点など"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" onclick="document.getElementById('consumable-modal').close()">キャンセル</button>
      <button type="button" class="btn btn-primary" id="save-consumable-btn">追加</button>
    </div>
  </div>
</dialog>

<!-- 担当者追加モーダル -->
<dialog id="staff-modal" class="chart-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>担当者を追加</h3>
      <button type="button" class="modal-close" onclick="document.getElementById('staff-modal').close()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="staff-select">担当者 <span class="required">*</span></label>
        <select id="staff-select" required>
          <option value="">選択してください</option>
        </select>
      </div>
      <div class="form-group">
        <label for="staff-start-date">担当開始日</label>
        <input type="date" id="staff-start-date">
      </div>
      <div class="form-group">
        <label for="staff-end-date">担当終了日</label>
        <input type="date" id="staff-end-date">
        <small class="form-hint">現在担当中の場合は空欄にしてください</small>
      </div>
      <div class="form-group">
        <label for="staff-notes">備考</label>
        <textarea id="staff-notes" rows="3" placeholder="特記事項があれば入力"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" onclick="document.getElementById('staff-modal').close()">キャンセル</button>
      <button type="button" class="btn btn-primary" id="save-staff-btn">追加</button>
    </div>
  </div>
</dialog>

<!-- クイックアクションドック -->
<nav class="quick-actions-dock" aria-label="クイックアクション">
  <a href="/sales/mypage" class="dock-item">
    <i class="fas fa-user-circle"></i>
    <span>マイページ</span>
  </a>
  <a href="/sales/clients" class="dock-item">
    <i class="fas fa-user-plus"></i>
    <span>顧客</span>
  </a>
  <a href="/sales/schedules" class="dock-item">
    <i class="fas fa-calendar"></i>
    <span>スケジュール</span>
  </a>
  <a href="/sales/estimates" class="dock-item">
    <i class="fas fa-briefcase"></i>
    <span>案件</span>
  </a>
</nav>

<script src="/js/sales-store-chart.js"></script>


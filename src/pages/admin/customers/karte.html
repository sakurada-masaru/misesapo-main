@layout('layouts.base')
@json('data/meta/admin_users_customers_title.json', $title)
@json('data/meta/admin_users_customers_body_class.json', $body_class)

<link rel="stylesheet" href="/css/admin-karte.css" />

<style>
  #default-header-wrapper,
  #normal-header-wrapper {
    display: none !important;
  }
</style>

<main id="main" class="karte-shell">
  <aside class="karte-sidebar">
    <a href="/admin/customers/" class="karte-back">
      <i class="fas fa-chevron-left"></i>
      <span>顧客管理に戻る</span>
    </a>

    <div class="karte-profile">
      <div class="profile-photo" id="karte-photo" aria-label="店舗外観"></div>
      <p class="profile-label">店舗カルテ</p>
      <h1 class="profile-title" id="store-name">-</h1>
      <p class="profile-meta" id="store-type">-</p>
    </div>

    <div class="karte-info">
      <div class="info-row">
        <span class="info-label">住所</span>
        <span class="info-value" id="store-address">-</span>
      </div>
      <div class="info-row">
        <span class="info-label">責任者</span>
        <span class="info-value" id="store-manager">-</span>
      </div>
      <div class="info-row">
        <span class="info-label">連絡先</span>
        <span class="info-value" id="store-contact">-</span>
      </div>
      <div class="info-row">
        <span class="info-label">カルテID</span>
        <span class="info-value" id="karte-id">-</span>
      </div>
    </div>

    <div class="karte-sidebar-foot">
      <div class="status-pill" id="karte-status-pill">未診断</div>
      <a href="#" class="ghost-btn" id="karte-edit-link" style="text-decoration: none;">
        <i class="fas fa-edit"></i>
        <span>編集する</span>
      </a>
      <button class="ghost-btn" id="karte-refresh" type="button">
        <i class="fas fa-sync-alt"></i>
        <span>更新</span>
      </button>
    </div>
  </aside>

  <section class="karte-main">
    <header class="karte-header">
      <div>
        <p class="header-kicker">Medical Sheet</p>
        <h2 class="header-title">メンテナンス履歴</h2>
        <p class="header-sub" id="karte-subtitle">最新の診断・清掃履歴を時系列で表示します。</p>
      </div>
    </header>

    <div class="karte-empty" id="karte-empty" hidden>
      <div class="empty-icon">
        <i class="fas fa-file-medical"></i>
      </div>
      <h3>カルテがまだ登録されていません</h3>
      <p>misesapo-kartes-api からカルテデータが届くと、履歴がここに表示されます。</p>
      <div style="margin-top: 24px;">
        <a href="#" id="karte-create-btn" class="btn-primary"
          style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; border-radius: 8px; text-decoration: none; background: #2563eb; color: white; font-weight: 600;">
          <i class="fas fa-plus-circle"></i>
          <span>今すぐカルテを登録する</span>
        </a>
      </div>
    </div>

    <div class="karte-timeline" id="karte-timeline"></div>
  </section>

  <aside class="karte-panel">
    <div class="panel-card">
      <div class="panel-head">
        <h3>清潔度メーター</h3>
        <span class="panel-tag">Score</span>
      </div>
      <div class="meter">
        <div class="meter-track">
          <div class="meter-bar" id="cleanliness-bar"></div>
        </div>
        <div class="meter-score">
          <span id="cleanliness-score">-</span>
          <small>/ 100</small>
        </div>
      </div>
      <p class="panel-note" id="cleanliness-note">清潔度スコアが未登録です。</p>
    </div>

    <div class="panel-card">
      <div class="panel-head">
        <h3>設備ステータス</h3>
        <span class="panel-tag">Vitals</span>
      </div>
      <div class="status-list" id="equipment-status-list"></div>
    </div>

    <div class="panel-card">
      <div class="panel-head">
        <h3>申し送り</h3>
        <span class="panel-tag">Notes</span>
      </div>
      <div class="note-stack" id="staff-notes"></div>
    </div>
  </aside>
</main>

<script src="/js/admin-karte.js" defer></script>
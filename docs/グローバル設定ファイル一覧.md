# グローバル設定ファイル一覧

## 概要

このプロジェクトでは、全ページに共通するグローバル設定が複数のファイルに分散して記述されています。

---

## 主要なグローバル設定ファイル

### 1. **`src/assets/js/role_config.js`** ⭐ 最重要
**役割**: ロール設定とページアクセス制御

**含まれる設定**:
- ロール定義（guest, customer, staff, concierge, admin, developer, master）
- ロール階層
- ロールごとのデフォルトページ（ログイン後リダイレクト先）
- ページ別アクセス制御
- ロールごとのナビゲーション項目

**使用箇所**: 全ページ（`base.html`で読み込み）

---

### 2. **`src/assets/js/firebase-config.js`** ⭐ 最重要
**役割**: Firebase設定

**含まれる設定**:
- Firebase API Key
- Firebase Auth Domain
- Firebase Project ID
- Firebase Storage Bucket
- Firebase Messaging Sender ID
- Firebase App ID
- Firebase Measurement ID

**使用箇所**: 全ページ（`base.html`で読み込み）

---

### 3. **`src/layouts/base.html`** ⭐ 最重要
**役割**: 全ページ共通のベースレイアウト

**含まれる設定**:
- HTML構造
- 共通ヘッダー・フッター
- 共通スクリプトの読み込み順序
- リリース前チェックセクション
- フィードバックボタン

**使用箇所**: 全ページ（`@layout('layouts.base')`で使用）

---

### 4. **`src/assets/styles.css`**
**役割**: グローバルCSSスタイル

**含まれる設定**:
- CSS変数（`--primary: #FF679C`など）
- グローバルスタイル
- 共通コンポーネントスタイル

**使用箇所**: 全ページ（`base.html`で読み込み）

---

## 全ページ共通項目

### 画面サイズ設定

#### 基本ルール：全幅画面で表示される
- **全てのページは全幅画面で表示される**
- `html, body { width: 100%; }` を適用
- 横スクロールを防ぐため `overflow-x: hidden` を適用
- **メインコンテンツ（キャンバス）は全幅**: `width: 100%` で全幅表示
  - メインコンテンツは画面幅いっぱいに表示される
  - パディングは内部に設定（コンテナやセクション内）

#### PC版：画面サイズ（フルスクリーンサイズ）
- **ヘッダー**: フルスクリーンサイズ（全幅）
- **ヒーローセクション**: フルスクリーンサイズ（全幅）
- **メインコンテンツ**: フルスクリーンサイズ（全幅、左右両端にパディング24px）
- **フッター**: フルスクリーンサイズ（全幅）

#### SP版：画面サイズ（フルスクリーンサイズ）
- **ブレークポイント**: 768px
- **ヒーローセクション**: フルスクリーンサイズ（全幅）
- **メインコンテンツ**: フルスクリーンサイズ（全幅、左右両端にパディング16px）
- **フッター**: フルスクリーンサイズ（全幅）

#### SP版：ヘッダー設定
- **表示項目**: ロゴ・ロール名・通知・ログアウトのみ表示
- **メニューボタン**: 画面左下にメニューボタンを設置
- **メニュー内容**: その他の項目（ナビゲーション項目など）をメニューボタン内に格納

#### フッター設定
- **背景**: グローバルカラーピンク（`--primary: #FF679C`）に白文字
- **高さ**: 50px

#### メインコンテンツ内のコンテナ設定
- **配置ルール**: メインコンテンツ内の要素は必ずコンテナ（`.container`）を作って配置
- **背景色**: 白背景（`background: #ffffff`）
- **パディング**: メインコンテンツ内パディングと同じ数値を設定
  - **PC版**: `padding: 0 24px`（左右24px）
  - **SP版（768px以下）**: `padding: 0 16px`（左右16px）

---

### レイアウト構造とルール

#### レイアウト構造の比喩（理解のための概念）

レイアウト構造を理解しやすくするため、以下の比喩を使用します：

- **キャンバス（テーブル）** = メインコンテンツ領域（`.main-canvas`）
- **コンテナ（皿）** = コンテンツを収める器（`.container`）
- **セクション（料理）** = コンテナ内に配置されるコンテンツ（`.section`）
- **要素（食材）** = セクション内のテキスト、画像などの要素

#### 基本レイアウトルール（必須遵守）

1. **キャンバスを超えてコンテナは表示できない**
   - コンテナ（皿）はキャンバス（テーブル）の境界を超えてはならない
   - CSS: `max-width: 100%`, `overflow: hidden` で制御

2. **コンテナは常に最大幅（100%）でなくてはならない**
   - コンテナ（皿）はセクション（料理）の大きさにかかわらず、常に最大幅（100%）を維持する
   - CSS: `width: 100%`, `min-width: 100%`, `max-width: 100%` で制御

3. **コンテナを超えてセクションは表示できない**
   - セクション（料理）はコンテナ（皿）の境界を超えてはならない
   - CSS: `max-width: 100%`, `box-sizing: border-box` で制御

3. **例外ルール: キャンバスに直接設置する装飾要素**
   - 以下の要素はキャンバス（テーブル）に直接設置可能（コンテナの外でもOK）：
     - **ヒーローセクション** = テーブル自体のデザイン（モニター内蔵の食卓テーブル）
     - **スクロールヒント** = テーブルに直接書かれたサイン（テーブル自体の装飾）
     - **アニメーション** = テーブルに直接描かれた絵（テーブル自体の装飾）
   - これらは「テーブルの装飾」として扱う

#### スライダーの扱い

- **セクション内スライダー** = 皿が回転する仕組み
  - コンテナ（皿）内で完結する
  - コンテナの境界を超えない
  - CSS: `overflow: hidden` で制御

- **コンテナスライダー** = 複数の皿を切り替える仕組み
  - キャンバス（テーブル）に直接設置（例外ルール適用）
  - 各コンテナはキャンバスサイズを超えてはならない
  - CSS: `max-width: 100%` で制御

#### z-index階層

以下のz-index階層を遵守：

1. **スプラッシュスクリーン** = `z-index: 1000`（最上位、テーブルカバー）
2. **モーダルパネル** = `z-index: 100`（メニューブック、料理の上に表示）
3. **テーブルの装飾** = `z-index: 10`（スクロールヒントなど）
4. **ヒーローセクション** = `z-index: 2`（テーブルの装飾）
5. **コンテナ（皿）** = `z-index: 1`（通常のコンテンツ）

#### その他のUI要素

- **モーダルパネル** = 料理のメニューブック
  - セクション（料理）の上に重ねて表示される
  - `z-index: 100` で制御

- **スプラッシュスクリーン** = テーブル全体を覆うテーブルカバー
  - キャンバス（テーブル）全体を覆う
  - コンテナ（皿）もセクション（料理）も全て隠す
  - `z-index: 1000` で制御（最上位）

#### CSS実装の注意点

- **全幅画面表示**:
  - `html, body { width: 100%; }` を適用（全幅画面で表示）
  - `html, body { overflow-x: hidden; }` を適用（横スクロール防止）
  - キャンバス（メインコンテンツ）も `width: 100%` で全幅表示
- すべての要素に `box-sizing: border-box` を適用
- コンテナとセクションには `max-width: 100%` を設定
- キャンバスには `overflow-x: hidden` を設定（横スクロール防止）
- コンテナスライダーには `overflow: hidden` を設定

#### CSS実装例（全幅画面表示）

```css
/* 全幅画面で表示される基本設定 */
html, body {
  width: 100%;
  overflow-x: hidden; /* 横スクロール防止 */
}

/* キャンバス（メインコンテンツ）も全幅表示 */
.main-canvas {
  width: 100%;
  overflow-x: hidden; /* 横スクロール防止 */
  overflow-y: auto; /* 縦スクロールは許可 */
}
```

---

### スペーシングシステム

#### 基本スペース（統一値）

以下の3つの値に統一：

- **8px** - 小さい間隔
- **16px** - 標準間隔
- **24px** - 大きい間隔

**それ以外の値**（32px, 40px, 48px, 64px など）は、独立した要素として扱う。

#### 適用ルール（コンテナ以下のルール）

以下のルールを守り、全画面表示にする：

1. **PCキャンバス（メインコンテンツ）**
   - 上下左右に **24px** のパディング
   - `padding: 0 24px`（左右24px）

2. **コンテナ内**
   - **16px** のパディング
   - `padding: 16px` または `padding: 0 16px`（用途に応じて）

3. **セクション内**
   - **16px** のパディング
   - `padding: 16px` または `padding: 0 16px`（用途に応じて）

4. **セクション間**
   - **16px** のマージン
   - `margin-bottom: 16px` など

5. **コンテナ間**
   - **24px** のマージン
   - `margin-bottom: 24px` など

#### 例外ルール

**ヒーローセクション**:
- キャンバスそのものに配置されるため、コンテナの幅に制限されない
- 常に全画面表示（`width: 100vw`）
- スペーシングシステムのルールは適用されない

---

### タイポグラフィシステム

#### フォントファミリー

**基本フォント**:
```css
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
```

#### フォントサイズの階層（タイポグラフィスケール）

**PC版**:
- **h1（大見出し）**: `32px` / `font-weight: 700` / `line-height: 1.4`
- **h2（中見出し）**: `24px` / `font-weight: 700` / `line-height: 1.5`
- **h3（小見出し）**: `20px` / `font-weight: 600` / `line-height: 1.5`
- **h4（サブ見出し）**: `18px` / `font-weight: 600` / `line-height: 1.5`
- **本文（body）**: `16px` / `font-weight: 400` / `line-height: 1.7`
- **小さいテキスト（small）**: `14px` / `font-weight: 400` / `line-height: 1.6`
- **最小テキスト（caption）**: `12px` / `font-weight: 400` / `line-height: 1.5`

**SP版（768px以下）**:
- **h1（大見出し）**: `24px` / `font-weight: 700` / `line-height: 1.4`
- **h2（中見出し）**: `20px` / `font-weight: 700` / `line-height: 1.5`
- **h3（小見出し）**: `18px` / `font-weight: 600` / `line-height: 1.5`
- **h4（サブ見出し）**: `16px` / `font-weight: 600` / `line-height: 1.5`
- **本文（body）**: `14px` / `font-weight: 400` / `line-height: 1.7`
- **小さいテキスト（small）**: `13px` / `font-weight: 400` / `line-height: 1.6`
- **最小テキスト（caption）**: `12px` / `font-weight: 400` / `line-height: 1.5`

#### フォントウェイトの使い分け

- **400 (normal)**: 本文テキスト、通常のテキスト
- **500 (medium)**: 強調したい本文、サブテキスト
- **600 (semibold)**: 小見出し、ボタン、リンク
- **700 (bold)**: 大見出し、中見出し、重要な強調
- **800 (extrabold)**: 特別な強調（使用は最小限に）

#### 行間（line-height）の統一

- **見出し（h1-h4）**: `1.4` - `1.5`（タイトな行間）
- **本文（body）**: `1.7`（読みやすい行間）
- **小さいテキスト**: `1.5` - `1.6`（コンパクトな行間）

#### レスポンシブ対応

- **ブレークポイント**: `768px`
- PC版とSP版でフォントサイズを適切に調整
- メディアクエリで `@media (max-width: 768px)` を使用

---

### 画像・メディア要素の扱い

#### 基本ルール

1. **画像の最大幅**
   - セクション内の画像は親要素の幅に収める
   - `max-width: 100%` を適用
   - `height: auto` でアスペクト比を維持

2. **アスペクト比の維持**
   - アスペクト比を維持する方法を統一
   - `aspect-ratio` プロパティを使用
   - `object-fit: cover` で画像を適切に表示

3. **レスポンシブ画像**
   - PC版とSP版で**別々の画像**を使用する
   - PC版用とSP版用の画像を用意
   - メディアクエリで画像を切り替える

4. **画像の配置**
   - 基本的には**中央揃え**（`text-align: center` または `margin: 0 auto`）
   - 必要に応じて左揃え、右揃えも使用可能

5. **画像の種類**
   - 背景画像、コンテンツ画像、アイコンなど、種類ごとにルールを分ける（詳細は保留）

#### CSS実装例

```css
/* 基本画像スタイル */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* 中央揃え */
.image-center {
  margin: 0 auto;
  display: block;
}

/* アスペクト比を維持 */
.image-aspect-ratio {
  aspect-ratio: 16 / 9;
  object-fit: cover;
}

/* レスポンシブ画像（PC/SPで別々の画像を使用） */
.responsive-image {
  /* PC版の画像 */
  background-image: url('/images/pc-image.jpg');
}

@media (max-width: 768px) {
  .responsive-image {
    /* SP版の画像 */
    background-image: url('/images/sp-image.jpg');
  }
}
```

---

### コンテナの高さ

**ルール**: コンテナの高さは、その都度確認して適切な値を設定する。固定ルールは設けない。

---

### グローバルカラー

**基本カラー**:
- `--primary: #FF679C` - プライマリカラー（ミセサポブランドカラー）
- `--primary-600: #E35687` - プライマリカラー（ホバー/ダーク）
- `--bg: #f8fafc` - 背景色（デフォルト）
- `--text: #494949` - テキスト色
- `--muted: #6b7280` - ミュートテキスト色
- `--border: #e5e7eb` - ボーダー色
- `--surface: #ffffff` - サーフェス色（カード背景など）
- `--alert: #ff3030` - アラート色

**インデックスページ背景色**:
- `#F8F4EC` - インデックスページ（トップページ）の背景色

---

### レスポンシブデザイン

#### ブレークポイント

- **SP版**: `768px以下`
- **PC版**: `769px以上`

#### スペーシングのレスポンシブ対応

**PC版**:
- キャンバス: 上下左右に **24px** のパディング
- コンテナ内: **16px** のパディング
- セクション内: **16px** のパディング
- セクション間: **16px** のマージン
- コンテナ間: **24px** のマージン

**SP版（768px以下）**:
- キャンバス: 上下左右に **16px** のパディング
- コンテナ内: **16px** のパディング
- セクション内: **16px** のパディング
- セクション間: **16px** のマージン
- コンテナ間: **16px** のマージン（PC版より小さく）

#### タイポグラフィのレスポンシブ対応

上記「タイポグラフィシステム」セクションを参照。

---

### 5. **`src/assets/app.js`**
**役割**: グローバルJavaScript機能

**含まれる設定**:
- ベースパス取得関数
- パス解決関数
- モーダル管理
- サービスアイテム表示

**使用箇所**: 全ページ（`base.html`で読み込み）

---

## その他の設定ファイル

### 6. **`src/assets/js/auth.js`**
**役割**: 認証機能

**含まれる設定**:
- 認証状態管理
- ログイン・ログアウト処理
- Firebase ID Token取得

**使用箇所**: 認証が必要なページ

---

### 7. **各ページ内の設定**
**例**: API URL設定

```javascript
// 各ページで個別に定義されている
const API_BASE_URL = 'https://2z0ui5xfxb.execute-api.ap-northeast-1.amazonaws.com/prod';
```

**該当ファイル**:
- `src/pages/admin/reports.html`
- `src/pages/admin/reports/new.html`
- `src/pages/admin/reports/[id]/edit.html`
- `src/pages/reports/[id].html`

---

## 推奨: グローバル設定ファイルの統合

現在、API URLなどが各ページで個別に定義されています。これらを統合することを推奨します。

### 提案: `src/assets/js/config.js` を作成

```javascript
/**
 * グローバル設定
 */
const GLOBAL_CONFIG = {
  // API設定
  API_BASE_URL: 'https://2z0ui5xfxb.execute-api.ap-northeast-1.amazonaws.com/prod',
  
  // サイト情報
  SITE_NAME: 'ミセサポ',
  COMPANY_NAME: '株式会社ミセサポ',
  
  // 連絡先
  CONTACT: {
    PHONE: '070-3332-3939',
    EMAIL: 'support@misesapo.com',
    WORKER_EMAIL: 'worker-support@misesapo.com',
    PARTNER_EMAIL: 'partner@misesapo.com'
  },
  
  // 営業時間
  BUSINESS_HOURS: {
    WEEKDAY: '9:00 - 18:00',
    SATURDAY: '9:00 - 13:00',
    SUNDAY: '休業',
    EMERGENCY: '24時間対応'
  },
  
  // その他の設定
  // ...
};

// グローバルに公開
window.GlobalConfig = GLOBAL_CONFIG;
```

**使用方法**:
```javascript
// 各ページで
const API_BASE_URL = window.GlobalConfig.API_BASE_URL;
```

---

## 現在の設定の確認方法

### ロール設定を確認
```javascript
// ブラウザのコンソールで
console.log(window.RoleConfig.ROLE_CONFIG);
```

### Firebase設定を確認
```javascript
// ブラウザのコンソールで
console.log(window.FirebaseAuth);
```

### グローバル設定を確認
```javascript
// ブラウザのコンソールで
console.log(window.GlobalConfig); // まだ作成されていない場合は undefined
```

---

## まとめ

**現在のグローバル設定ファイル**:
1. ✅ `src/assets/js/role_config.js` - ロール設定
2. ✅ `src/assets/js/firebase-config.js` - Firebase設定
3. ✅ `src/layouts/base.html` - ベースレイアウト
4. ✅ `src/assets/styles.css` - グローバルCSS
5. ✅ `src/assets/app.js` - グローバルJS

**改善提案**:
- `src/assets/js/config.js` を作成して、API URL、連絡先、営業時間などを一元管理


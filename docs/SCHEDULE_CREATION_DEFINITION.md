# スケジュール作成の定義

## 概要

Googleカレンダーから抽出したスケジュール情報をもとに、システム上でスケジュールを作成する際の定義（テンプレート）を作成します。

## 抽出されたスケジュール情報の構造

### 基本情報

- **日付**: `scheduled_date` (YYYY-MM-DD形式)
- **時間**: `scheduled_time` (HH:MM形式)
- **店舗名**: `store_name`
- **クライアント名**: `client_name`
- **住所**: `address`
- **清掃項目**: `cleaning_items` (配列)
- **備考**: `notes`
- **ステータス**: `status` (draft, scheduled, in_progress, completed, cancelled)

### 現在のデータ状況

- **総スケジュール数**: 100件
- **ステータス**: すべて `draft`（未確定）
- **日付範囲**: 2025-12-15 〜 2026-01-14（今日から30日後まで）

## Googleカレンダーイベントの形式

### タイトル（summary）の形式

1. **【定期清掃】クライアント名 店舗名（備考）**
   - 例: `【定期清掃】元気ダイニング  大衆焼肉酒場こがね（日曜定休）`
   - 例: `【定期清掃】株式会社オン・ザ・プラネット　ホルモンのマンモス`

2. **その他の形式**
   - 例: `オフィス`
   - 例: `口座残高確認`
   - 例: `ダイナースカード　締日`

### 説明（description）の形式

清掃項目は以下のような形式で記載されています：

```
【毎月実施】
・グリストラップ清掃
・キッチン床清掃
・ホール床清掃
・グリスフィルター清掃
・エアコンフィルター清掃
・害虫駆除
・ネズミ駆除

【隔月（奇数月：1・3・5・7・9・11月）】
・レンジフード分解清掃（2基）

【年1回（10月）】
・ファンモーター点検

キーボックス
ポスト左5 右3
```

または：

```
グリストラップ（毎月）        1    　
天カセエアコンフィルター（毎月）        3    　
厨房機器まわり（都度）        3    　
冷蔵庫フィルター清掃（毎月）        6    　
害虫駆除（毎月）        1    　
グリスフィルター（毎月）        6    　
レンジフード（隔月）        3　　→ 1月.3月.5月.7月.9月.11月
キッチン床（隔月）        1　　→1月.3月.5月.7月.9月.11月
```

## スケジュール作成の定義

### 1. 必須項目

- **日付** (`scheduled_date`): YYYY-MM-DD形式
- **時間** (`scheduled_time`): HH:MM形式
- **店舗名** (`store_name`): 文字列

### 2. オプション項目

- **クライアント名** (`client_name`): 文字列
- **住所** (`address`): 文字列
- **清掃項目** (`cleaning_items`): 配列
  - 形式: `[{"name": "グリストラップ清掃"}, {"name": "キッチン床清掃"}]`
- **備考** (`notes`): 文字列
- **ステータス** (`status`): `draft`（デフォルト）

### 3. 清掃項目の分類

#### 頻度別分類

1. **毎月実施**
   - グリストラップ清掃
   - キッチン床清掃
   - ホール床清掃
   - グリスフィルター清掃
   - エアコンフィルター清掃
   - 害虫駆除
   - ネズミ駆除
   - 冷蔵庫フィルター清掃
   - レンジフード拭きあげ
   - トイレ清掃
   - など

2. **隔月実施**
   - レンジフード分解清掃
   - キッチン床清掃（特定月のみ）
   - ホール床清掃（特定月のみ）
   - など

3. **四半期実施**（2・5・8・11月など）
   - レンジフード／ダクト清掃
   - シンク清掃
   - など

4. **半年実施**（5月・10月など）
   - キッチン配管高圧洗浄
   - 厨房壁清掃
   - など

5. **年1回実施**（10月など）
   - ファンモーター点検
   - エアコン分解洗浄
   - 排気/換気口清掃
   - など

6. **都度対応**
   - 厨房機器まわり清掃
   - ガス台清掃
   - U字溝／グレーチング清掃
   - など

## システム上でのスケジュール作成フロー

### 1. スケジュール作成画面

**ページ**: `/admin/schedules/index.html` → 「新規作成」ボタン

### 2. 入力項目

1. **店舗・ブランド・法人名**
   - 既存の店舗から選択、または新規入力
   - 検索機能あり

2. **日付・時間**
   - 日付: カレンダー選択
   - 時間: 時刻入力（HH:MM形式）

3. **作業時間（分）**
   - デフォルト: 60分
   - 15分単位で設定可能

4. **営業担当者**
   - ドロップダウンから選択

5. **担当清掃員**
   - ドロップダウンから選択（未割当も可能）

6. **清掃内容**
   - サービス一覧から選択
   - 複数選択可能

7. **ステータス**
   - 未確定（draft）
   - 確定（scheduled）
   - 作業中（in_progress）
   - 完了（completed）
   - キャンセル（cancelled）

8. **備考**
   - 自由記述

### 3. 保存処理

- **API**: `POST /schedules`
- **ステータス**: `draft`（デフォルト）
- **作成者**: ログインユーザー

## 今後の運用方針

### 1. スケジュール作成

- **システム上から作成**: 管理ダッシュボードの「新規作成」ボタンから作成
- **Googleカレンダーとの同期**: 不要（今回の同期は一度限り）

### 2. データ管理

- **スケジュールID**: システム側で自動生成（`SCH-YYYYMMDD-NNN`形式）
- **GoogleカレンダーイベントID**: 保存しない（今後は紐付け不要）

### 3. 清掃項目の管理

- **サービス一覧**: `/admin/services/index.html`で管理
- **スケジュール作成時**: サービス一覧から選択して紐付け

## 抽出されたスケジュール情報の活用

### 1. 店舗情報の整理

抽出されたスケジュールから、以下の情報を整理できます：

- **店舗名一覧**: 重複を除いた店舗名のリスト
- **クライアント名一覧**: 重複を除いたクライアント名のリスト
- **住所情報**: 店舗ごとの住所

### 2. 清掃項目の標準化

Googleカレンダーから抽出した清掃項目を、システムのサービス一覧に登録：

- **グリストラップ清掃**
- **キッチン床清掃**
- **ホール床清掃**
- **グリスフィルター清掃**
- **エアコンフィルター清掃**
- **害虫駆除**
- **ネズミ駆除**
- **レンジフード清掃**
- **ダクト清掃**
- **ファンモーター点検**
- など

### 3. スケジュールテンプレートの作成

頻度別の清掃項目を組み合わせたテンプレートを作成：

- **基本清掃テンプレート**: 毎月実施の項目
- **定期清掃テンプレート**: 毎月 + 隔月の項目
- **総合清掃テンプレート**: すべての項目

## 次のステップ

1. **店舗情報の整理**
   - 抽出された店舗名を、既存の店舗データと照合
   - 新規店舗として登録が必要なものを特定

2. **清掃項目の標準化**
   - 抽出された清掃項目を、システムのサービス一覧に登録
   - 重複を排除し、標準的な名称に統一

3. **スケジュールテンプレートの作成**
   - 頻度別の清掃項目を組み合わせたテンプレートを作成
   - 店舗ごとのテンプレートを作成

4. **既存スケジュールの整理**
   - 抽出されたスケジュールの情報を補完
   - 店舗情報、清掃項目を正しく紐付け


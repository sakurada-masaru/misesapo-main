# ミセサポ サイトマップ提案書

## 前提条件
- **ユーザー（個人・法人）**: サービスを受ける側（顧客）
- **清掃員**: サービスを実施する側（現場作業員）
- **営業マン**: 顧客対応・営業活動を行う側
- **管理者**: システム全体を管理する側

## デバイス対応方針
- **管理者**: PC操作メイン（デスクトップ・ラップトップ優先）
- **営業マン**: SPメイン（スマートフォン優先、PCでもアクセス可能）
- **清掃員**: SPのみ（スマートフォン専用、現場での操作を想定）
- **ユーザー（顧客）**: SPメインでPCもあり（スマートフォン優先、PCでも利用可能）

---

## 1. パブリックサイト（未認証ユーザー向け）

### 1.1 トップページ・LP
- `/` - トップページ（ランディングページ）
  - サービス紹介
  - 料金プラン
  - 導入事例
  - お問い合わせフォーム

### 1.2 認証前
- `/signin` - ログイン
- `/signup` - 新規登録（個人）
- `/signup/corporation` - 新規登録（法人）
- `/reset-password` - パスワードリセット
- `/privacy` - プライバシーポリシー
- `/terms` - 利用規約
- `/contact` - お問い合わせ（未認証）

---

## 2. ユーザー（顧客）向けサイト（SPメイン、PCもあり）

**注意**: すべてのページはスマートフォン優先設計。PCでもアクセス可能で、両方のデバイスで快適に利用できる。

### 2.1 ダッシュボード
- `/mypage` - マイページ（ダッシュボード、SPメイン・PC対応）
  - 予約状況一覧（SP最適化、PCでも見やすい）
  - 清掃予定カレンダー（SP: 簡易表示、PC: 詳細表示）
  - お知らせ（SP・PC対応）
  - クイックアクション（SP: タッチ操作、PC: クリック操作）

### 2.2 発注・予約
- `/order` - 発注ページ（サービス一覧、SPメイン・PC対応）※現在は `/index.html`
- `/cart` - カート（選択したサービス一覧・数量変更、SPメイン・PC対応）
- `/checkout` - 確認・決済（発注内容確認・支払い方法選択、SPメイン・PC対応）
- `/order/complete` - 発注完了（発注完了画面・確認メール送信、SPメイン・PC対応）
- `/order/history` - 発注履歴（SPメイン・PC対応）
  - `/order/history/[id]` - 発注詳細（SPメイン・PC対応）

### 2.3 レポート・確認
- `/reports` - 清掃レポート一覧
  - `/reports/[id]` - 清掃レポート詳細（写真・作業内容）
- `/schedule` - 清掃予定一覧
  - `/schedule/[id]` - 予定詳細

### 2.4 アカウント管理
- `/mypage/info` - アカウント情報
  - 基本情報
  - 店舗情報
  - 支払い方法
- `/mypage/stores` - 登録店舗管理
  - `/mypage/stores/[id]` - 店舗詳細
  - `/mypage/stores/new` - 店舗追加
- `/mypage/inquiry` - お問い合わせ（認証済み）
- `/mypage/settings` - 設定
  - 通知設定
  - パスワード変更
  - 退会

---

## 3. 清掃員向けサイト（SP専用）

**注意**: すべてのページはスマートフォン専用設計。PCでのアクセスは制限または簡易表示のみ。

### 3.1 ダッシュボード
- `/staff/dashboard` - 清掃員ダッシュボード（SP専用）
  - 本日の予定（一覧表示）
  - 今週の予定（簡易カレンダー）
  - 作業完了待ち
  - 通知（プッシュ通知対応）

### 3.2 作業管理
- `/staff/assignments` - 割り当てられた作業一覧（SP専用）
  - `/staff/assignments/[id]` - 作業詳細（SP専用）
    - 作業内容確認
    - 現場情報（地図表示）
    - 作業開始（位置情報取得）
    - 作業完了報告
- `/staff/reports` - 作成したレポート一覧（SP専用）
  - `/staff/reports/[id]` - レポート詳細
- `/staff/reports/new` - レポート作成（SP専用）
  - 作業内容入力（タッチ入力最適化）
  - 写真アップロード（カメラ連携）
  - GPS位置情報取得
  - 完了報告

### 3.3 スケジュール
- `/staff/schedule` - 自分のスケジュール（SP専用）
  - カレンダー表示（SP最適化）
  - 作業予定一覧

### 3.4 アカウント管理
- `/staff/profile` - プロフィール（SP専用）
- `/staff/settings` - 設定（SP専用）
- `/staff/attendance` - 勤怠管理（SP専用、位置情報連携）

---

## 4. 営業マン向けサイト（SPメイン）

**注意**: すべてのページはスマートフォン優先設計。PCでもアクセス可能だが、SP向けのUI/UXを基準とする。

### 4.1 ダッシュボード
- `/sales/dashboard` - 営業ダッシュボード（SPメイン）
  - 担当顧客一覧（SP最適化）
  - 新規問い合わせ（通知対応）
  - 発注状況（簡易表示）
  - 売上サマリー（グラフ表示）

### 4.2 顧客管理
- `/sales/clients` - 顧客一覧（SPメイン）
  - `/sales/clients/[id]` - 顧客詳細（SPメイン）
    - 基本情報
    - 発注履歴
    - 清掃履歴
    - メモ・履歴（タッチ入力最適化）
- `/sales/clients/new` - 新規顧客登録（SPメイン）
- `/concierge` - コンシェルジュページ（顧客情報閲覧、SPメイン）

### 4.3 見積もり管理（SPメイン）
- `/sales/estimates` - 見積もり一覧（SPメイン）
  - `/sales/estimates/[id]` - 見積もり詳細（SPメイン）
    - 見積もり内容確認（SP最適化表示）
    - 編集・修正（タッチ入力最適化）
    - PDF出力（SPでも生成可能）
    - メール送信（SPから直接送信可能）
  - `/sales/estimates/new` - 新規見積もり作成（SPメイン）
    - 顧客選択（検索・絞り込み機能）
    - サービス選択（複数可、タッチ操作）
    - 料金計算（自動計算）
    - 見積書テンプレート選択
    - 備考・特記事項入力（タッチ入力）
    - 有効期限設定（カレンダー選択）
    - 下書き保存（SPでも保存可能）
  - `/sales/estimates/draft` - 下書き一覧（SPメイン）
  - `/sales/estimates/sent` - 送付済み見積もり（SPメイン）
  - `/sales/estimates/approved` - 承認済み見積もり（SPメイン）
  - `/sales/estimates/rejected` - 却下・失効見積もり（SPメイン）

### 4.4 発注管理
- `/sales/orders` - 発注一覧
  - `/sales/orders/[id]` - 発注詳細
  - 発注承認・却下
- `/sales/orders/pending` - 承認待ち発注

### 4.5 スケジュール管理
- `/sales/schedule` - スケジュール管理
  - 訪問予定
  - 顧客訪問履歴

### 4.6 レポート・分析
- `/sales/reports` - レポート確認
- `/sales/analytics` - 売上分析

---

## 5. 管理者向けサイト（PCメイン）

**注意**: すべてのページはPC操作を前提とした設計。レスポンシブ対応は行うが、PCでの操作性を最優先とする。

### 5.1 ダッシュボード
- `/admin/dashboard` - 管理ダッシュボード（PCメイン）
  - システム全体のサマリー（グラフ・表形式）
  - 重要通知（PC向け通知表示）
  - 統計情報（詳細データ表示）

### 5.2 ユーザー管理
- `/admin/users` - ユーザー管理（PCメイン）
  - `/admin/users/customers` - 顧客一覧（表形式、検索・フィルタ機能）
  - `/admin/users/staff` - 清掃員一覧（表形式）
  - `/admin/users/sales` - 営業マン一覧（表形式）
  - `/admin/users/[id]` - ユーザー詳細（詳細情報表示）

### 5.3 発注・作業管理
- `/admin/orders` - 発注管理（全体、PCメイン）
  - `/admin/orders/[id]` - 発注詳細（詳細情報表示）
- `/admin/assignments` - 作業割り当て管理（PCメイン、ドラッグ&ドロップ対応）
- `/admin/schedule` - スケジュール管理（全体、PCメイン、カレンダー表示）

### 5.4 サービス管理
- `/admin/services` - サービス項目管理（PCメイン）
  - サービス追加・編集・削除（表形式管理）
  - 料金設定（一括編集機能）
- `/admin/categories` - カテゴリ管理（PCメイン）

### 5.5 レポート管理
- `/admin/reports` - レポート管理（全体、PCメイン）
- `/admin/reports/pending` - 承認待ちレポート（PCメイン）

### 5.6 システム管理
- `/admin/settings` - システム設定（PCメイン）
  - 基本設定（詳細設定項目）
  - 通知設定
  - メールテンプレート（エディタ機能）
- `/admin/logs` - ログ管理（PCメイン、検索・フィルタ機能）
- `/admin/analytics` - 分析・統計（PCメイン、詳細グラフ・レポート）
- `/admin/sitemap` - サイトマップ（管理用、PCメイン）

### 5.7 マスタ管理
- `/admin/masters` - マスタデータ管理（PCメイン）
  - 店舗タイプ
  - エリア
  - その他（表形式管理）

---

## 6. API エンドポイント（想定）

### 6.1 認証
- `POST /api/auth/login` - ログイン
- `POST /api/auth/logout` - ログアウト
- `POST /api/auth/register` - 新規登録
- `POST /api/auth/reset-password` - パスワードリセット

### 6.2 発注
- `GET /api/orders` - 発注一覧取得
- `POST /api/orders` - 発注作成
- `GET /api/orders/[id]` - 発注詳細
- `PUT /api/orders/[id]` - 発注更新
- `DELETE /api/orders/[id]` - 発注削除

### 6.3 レポート
- `GET /api/reports` - レポート一覧
- `POST /api/reports` - レポート作成
- `GET /api/reports/[id]` - レポート詳細

### 6.4 スケジュール
- `GET /api/schedule` - スケジュール取得
- `POST /api/schedule` - スケジュール作成

### 6.5 顧客管理（営業マン・管理者）
- `GET /api/clients` - 顧客一覧
- `GET /api/clients/[id]` - 顧客詳細

---

## 7. 権限管理の考え方

### 7.1 ロール定義
- **guest**: 未認証ユーザー（パブリックサイトのみ）
- **customer**: 顧客（個人・法人）
- **staff**: 清掃員
- **sales**: 営業マン
- **admin**: 管理者

### 7.2 アクセス制御
- 各ページはロールベースのアクセス制御を実装
- 未認証ユーザーは `/signin` にリダイレクト
- 権限のないページアクセス時は 403 エラー

---

## 8. 実装優先順位（推奨）

### Phase 1: コア機能（必須）
1. 認証機能（ログイン・登録）
2. ユーザー向け：発注機能
3. ユーザー向け：レポート閲覧
4. 営業マン向け：顧客管理
5. 営業マン向け：見積もり作成・管理
6. 管理者向け：ユーザー管理

### Phase 2: 業務機能
6. 清掃員向け：作業管理・レポート作成
7. スケジュール管理
8. 発注承認フロー
9. 通知機能

### Phase 3: 高度な機能
10. 分析・レポート機能
11. マスタ管理
12. API 公開

---

## 9. 現状との比較

### 現状あるページ
- ✅ `/index.html` - 発注ページ（ユーザー向け・サービス一覧）
- ✅ `/signin.html` - ログイン
- ✅ `/signup.html` - 新規登録
- ✅ `/mypage.html` - マイページ（ユーザー向け）
- ✅ `/report.html` - レポート一覧
- ✅ `/reports/[id].html` - レポート詳細
- ✅ `/concierge.html` - コンシェルジュ（営業マン向け？）
- ✅ `/cart.html` - カート（選択サービス一覧・数量変更）
- ✅ `/checkout.html` - 決済確認（発注内容確認・支払い方法選択）
- ✅ `/order-complete.html` - 発注完了
- ✅ `/order-confirm.html` - 発注確認

### 不足しているページ
- ❌ 清掃員向けページ（一切なし）
- ❌ 営業マン向けダッシュボード
- ❌ 管理者向けページ（`/admin/sitemap.html` のみ）
- ❌ 顧客管理ページ
- ❌ 作業割り当て・管理ページ
- ❌ スケジュール管理ページ
- ❌ レポート作成ページ（清掃員用）

---

## 10. デバイス対応の実装方針

### 10.1 レスポンシブ設計の優先順位
1. **管理者（PCメイン）**: PCでの操作性を最優先。タブレット・スマートフォンは簡易表示のみ。
2. **営業マン（SPメイン）**: スマートフォンでの操作性を最優先。PCでも主要機能は利用可能。
3. **清掃員（SPのみ）**: スマートフォン専用設計。PCでのアクセスは制限または簡易表示のみ。
4. **ユーザー（SPメイン、PCもあり）**: スマートフォンを優先するが、PCでも快適に利用できる設計。

### 10.2 実装時の注意点
- **ブレークポイント**: SP（〜768px）、PC（769px〜）を基本とする
- **管理者ページ**: 最小画面幅1024pxを推奨
- **清掃員ページ**: スマートフォン専用のため、PCアクセス時は警告表示
- **タッチ操作**: SP向けページはタッチ操作を最適化
- **入力方式**: PCではキーボード入力、SPではタッチ入力に最適化

## 11. 次のステップ

1. **現状のサイトマップを更新** - この提案を反映
2. **優先順位を決定** - Phase 1 から実装開始
3. **ロールベースのアクセス制御設計** - 権限管理の詳細設計
4. **デバイス別UI/UX設計** - 各ロールのデバイス要件に基づいた設計
5. **ページ設計書作成** - 各ページの詳細仕様（デバイス別対応含む）
6. **データベース設計** - 必要なテーブル設計


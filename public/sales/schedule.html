<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <title>スケジュール管理 | ミセサポ</title>
    <link rel="icon" type="image/png" href="/images/logo_144x144.png" />
<link rel="shortcut icon" href="/images/logo_144x144.png" />
<link rel="apple-touch-icon" href="/images/logo_144x144.png" />
<link rel="stylesheet" href="/styles.css" />
<link rel="stylesheet" href="/css/header.css" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<!-- 
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet" />
-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  body { font-family: 'Noto Sans JP', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif; }
  /* Brand theme variables (default + variants) */
  body { --primary: #FF679C; --primary-600: #E35687; }
  body.theme-pink { --primary: #FF679C; --primary-600: #E35687; }
  body.theme-blue { --primary: #2563eb; --primary-600: #1d4ed8; }
  body.theme-emerald { --primary: #10b981; --primary-600: #059669; }
  /* Note: :root also defines the same brand color; inline vars ensure early paint */
  </style>

  </head>
  <body class="theme-pink page-sales-schedule">
    <div id="default-header-wrapper">
    <a class="skip-link" href="#main">メインコンテンツへスキップ</a>
<header id="header-guest" class="site-header" data-role="guest">
  <div class="inner wide">
    <div class="nav-left">
      <a class="brand brand-logo" href="/index.html" aria-label="ミセサポ ホーム">
        <img src="/images/logo_144x144.png" alt="ミセサポ" />
      </a>
      <nav id="nav-guest" class="nav-left hide-sm" aria-label="Primary">
        <!-- ナビゲーション項目はJavaScriptで動的に生成されます -->
      </nav>
    </div>
    <div class="spacer"></div>
    <nav class="nav-right hide-sm" aria-label="User">
      <span class="role-badge" style="padding: 4px 12px; background: #e5e7eb; color: #6b7280; border-radius: 4px; font-size: 0.875rem; font-weight: 500;">ゲスト</span>
      <a class="nav-link" href="/signin.html">ログイン</a>
      <a class="nav-link primary" href="/signup.html">新規登録</a>
      <button class="icon-btn" aria-label="通知">
        <i class="fas fa-bell"></i>
      </button>
      <button class="icon-btn" aria-label="ログアウト" onclick="window.Auth && window.Auth.logout()" style="display: none;">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </nav>
    <button class="hamburger-btn show-sm" aria-label="メニュー" aria-expanded="false" id="hamburger-btn">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>
  <!-- スマホ版ナビゲーションメニュー -->
  <nav class="mobile-nav show-sm" id="mobile-nav" aria-label="モバイルナビゲーション">
    <div class="mobile-nav-content">
      <nav class="mobile-nav-primary" id="mobile-nav-primary" aria-label="Primary">
        <!-- ナビゲーション項目はJavaScriptで動的に生成されます -->
      </nav>
      <nav class="mobile-nav-user" aria-label="User">
        <span class="role-badge" style="padding: 4px 12px; background: #e5e7eb; color: #6b7280; border-radius: 4px; font-size: 0.875rem; font-weight: 500;">ゲスト</span>
        <a class="mobile-nav-link" href="/signin.html">ログイン</a>
        <a class="mobile-nav-link primary" href="/signup.html">新規登録</a>
      </nav>
    </div>
  </nav>
</header>

    </div>
    <!-- 通常ヘッダー（ログイン画面用） -->
    <div id="normal-header-wrapper" style="display: none;">
    <!-- 通常ヘッダー -->
<header class="normal-header">
    <div class="normal-header-inner">
        <div class="normal-header-logo">
            <a href="/">
                <img id="normal-header-logo-img" src="/images-material/logo_144x144.png" alt="ロゴ" onerror="this.style.display='none'">
            </a>
                </div>
        <nav class="normal-header-nav">
            <a href="/">TOP</a>
            <a href="/service.html">対応可能サービス</a>
            <a href="/lp.html#voice">お客様の声</a>
            <a href="/customers-support-desk.html">カスタマーズサポート</a>
            <a href="/announcements.html">お知らせ</a>
            <a href="/privacy-policy.html">規約＆ポリシー</a>
        </nav>
        <div class="normal-header-actions">
            <a href="/signin.html" class="normal-header-login">ログイン</a>
        </div>
            </div>
</header>


    </div>
    <main id="main">
      





<main id="main" class="container sales-schedule">
  <div class="page-header">
    <a href="/sales/dashboard.html" class="back-btn">
      <i class="fas fa-chevron-left"></i>
    </a>
    <h1 class="page-title">スケジュール管理</h1>
    <a href="/sales/schedules/new.html" class="btn btn-primary btn-sm">
      <i class="fas fa-plus"></i> 追加
    </a>
  </div>

  <!-- View Tabs -->
  <div class="view-tabs">
    <button class="view-tab active" data-view="month">
      <i class="fas fa-calendar-alt"></i> 月次
    </button>
    <button class="view-tab" data-view="week">
      <i class="fas fa-calendar-week"></i> 週次
    </button>
    <button class="view-tab" data-view="day">
      <i class="fas fa-calendar-day"></i> 日次
    </button>
  </div>

  <!-- Month View -->
  <div class="view-container" id="month-view">
    <div class="calendar-nav">
      <button class="nav-btn" id="prev-month">
        <i class="fas fa-chevron-left"></i>
      </button>
      <h2 class="calendar-month" id="current-month">2025年3月</h2>
      <button class="nav-btn" id="next-month">
        <i class="fas fa-chevron-right"></i>
      </button>
      <button class="nav-btn today-btn" id="today-month">
        <i class="fas fa-calendar-day"></i> 今日
      </button>
    </div>

    <!-- Circular Component for Month View -->
    <div class="circular-component-wrapper">
      <div class="circular-component" id="month-circular-component">
        <div class="reference-point"></div>
        <svg viewBox="0 0 200 200" class="circular-svg">
          <!-- SVG will be generated by JavaScript -->
        </svg>
        <div class="circular-center">
          <div class="center-day-of-week" id="month-day-of-week"></div>
          <div class="center-date" id="month-date"></div>
          <div class="center-schedule-count" id="month-schedule-count"></div>
      </div>
      </div>
    </div>

    <!-- Schedule List for Selected Date -->
    <div class="circular-schedule-list" id="month-schedule-list">
      <!-- Schedules will be rendered here -->
    </div>
  </div>

  <!-- Week View -->
  <div class="view-container hidden" id="week-view">
    <div class="week-nav">
      <button class="nav-btn" id="prev-week">
        <i class="fas fa-chevron-left"></i>
      </button>
      <h2 class="week-range" id="week-range">2025年3月24日 - 3月30日</h2>
      <button class="nav-btn" id="next-week">
        <i class="fas fa-chevron-right"></i>
      </button>
      <button class="nav-btn today-btn" id="today-week">
        <i class="fas fa-calendar-day"></i> 今週
      </button>
    </div>


    <!-- Schedule List for Selected Day -->
    <div class="circular-schedule-list" id="week-schedule-list">
      <!-- Schedules will be rendered here -->
    </div>
  </div>

  <!-- Day View -->
  <div class="view-container hidden" id="day-view">
    <div class="day-nav">
      <button class="nav-btn" id="prev-day">
        <i class="fas fa-chevron-left"></i>
      </button>
      <h2 class="day-date" id="current-day">2025年3月28日</h2>
      <button class="nav-btn" id="next-day">
        <i class="fas fa-chevron-right"></i>
      </button>
      <button class="nav-btn today-btn" id="today-day">
        <i class="fas fa-calendar-day"></i> 今日
      </button>
    </div>

    <!-- Day Period Toggle Buttons -->
    <div class="day-period-toggle">
      <button class="period-btn active" id="period-morning" data-period="morning">
        <i class="fas fa-sun"></i> 午前
      </button>
      <button class="period-btn" id="period-afternoon" data-period="afternoon">
        <i class="fas fa-moon"></i> 午後
      </button>
    </div>

    <!-- Circular Component for Day View -->
    <div class="circular-component-wrapper">
      <div class="circular-component" id="day-circular-component">
        <div class="reference-point"></div>
        <svg viewBox="0 0 200 200" class="circular-svg">
          <!-- SVG will be generated by JavaScript -->
        </svg>
        <div class="circular-center">
          <i class="fas fa-sun day-icon" id="day-icon-sun"></i>
          <i class="fas fa-moon day-icon" id="day-icon-moon"></i>
          <div class="center-period" id="day-period"></div>
          <div class="center-time-range" id="day-time-range"></div>
          <div class="center-schedule-count" id="day-schedule-count"></div>
        </div>
      </div>
    </div>

    <!-- Schedule List for Selected Time Period -->
    <div class="circular-schedule-list" id="day-schedule-list">
      <!-- Schedules will be rendered here -->
    </div>
  </div>

  <!-- Schedule Modal -->
  <div class="modal" id="schedule-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modal-title">スケジュール追加</h3>
        <button class="modal-close" id="modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="schedule-form">
        <input type="hidden" id="schedule-id" name="id">
        
        <div class="form-group">
          <label for="schedule-date" class="form-label">日付 <span class="required">*</span></label>
          <input type="date" id="schedule-date" name="date" class="form-input" required>
        </div>

        <div class="form-group">
          <label for="schedule-time" class="form-label">時間 <span class="required">*</span></label>
          <input type="time" id="schedule-time" name="time" class="form-input" required>
        </div>

        <div class="form-group">
          <label for="schedule-client" class="form-label">顧客 <span class="required">*</span></label>
          <select id="schedule-client" name="client_id" class="form-input" required>
            <option value="">選択してください</option>
          </select>
        </div>

        <div class="form-group">
          <label for="schedule-store" class="form-label">店舗</label>
          <input type="text" id="schedule-store" name="store_name" class="form-input" placeholder="店舗名を入力">
        </div>

        <div class="form-group">
          <label for="schedule-purpose" class="form-label">訪問目的 <span class="required">*</span></label>
          <select id="schedule-purpose" name="purpose" class="form-input" required>
            <option value="">選択してください</option>
            <option value="見積もり提出">見積もり提出</option>
            <option value="商談">商談</option>
            <option value="定期訪問">定期訪問</option>
            <option value="清掃状況確認">清掃状況確認</option>
            <option value="その他">その他</option>
          </select>
        </div>

        <div class="form-group">
          <label for="schedule-address" class="form-label">住所</label>
          <input type="text" id="schedule-address" name="address" class="form-input" placeholder="住所を入力">
        </div>

        <div class="form-group">
          <label for="schedule-phone" class="form-label">電話番号</label>
          <input type="tel" id="schedule-phone" name="phone" class="form-input" placeholder="電話番号を入力">
        </div>

        <div class="form-group">
          <label for="schedule-email" class="form-label">メールアドレス</label>
          <input type="email" id="schedule-email" name="email" class="form-input" placeholder="メールアドレスを入力">
        </div>

        <div class="form-group">
          <label for="schedule-notes" class="form-label">備考</label>
          <textarea id="schedule-notes" name="notes" class="form-input form-textarea" rows="3" placeholder="備考を入力"></textarea>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-outline" id="modal-cancel">キャンセル</button>
          <button type="submit" class="btn btn-primary" id="modal-submit">保存</button>
          <button type="button" class="btn btn-danger hidden" id="modal-delete">削除</button>
        </div>
      </form>
    </div>
  </div>

  <style>
    /* ヘッダーとフッターを非表示 */
    body.page-sales-schedule #default-header-wrapper,
    body.page-sales-schedule #normal-header-wrapper,
    body.page-sales-schedule .site-footer {
      display: none !important;
    }
    
    /* メインコンテンツを全画面表示 */
    body.page-sales-schedule #main {
      min-height: 100vh;
      padding-top: 0;
    }
    
    .sales-schedule {
      max-width: 100%;
      margin: 0;
      padding: 16px;
      background: #f9fafb;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .page-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding: 12px 16px;
      padding-bottom: 16px;
      border-bottom: 2px solid #e5e7eb;
      position: sticky;
      top: 0;
      background: #f9fafb;
      z-index: 100;
    }
    .back-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #ffffff;
      border: 1px solid #e5e7eb;
      color: #374151;
      text-decoration: none;
      transition: all 0.2s;
    }
    .back-btn:hover {
      background: #f9fafb;
      border-color: var(--primary);
      color: var(--primary);
    }
    .page-title {
      flex: 1;
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      margin: 0;
    }
    .view-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      background: #ffffff;
      padding: 8px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .view-tab {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      background: transparent;
      color: #6b7280;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .view-tab:hover {
      background: #f9fafb;
      color: #374151;
    }
    .view-tab.active {
      background: var(--primary);
      color: #ffffff;
    }
    .view-container {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .view-container.hidden {
      display: none;
    }
    .calendar-nav,
    .week-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding: 12px;
      background: #f9fafb;
      border-radius: 12px;
    }
    .nav-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 8px 16px;
      border-radius: 8px;
      background: #ffffff;
      border: 1px solid #e5e7eb;
      color: #374151;
      cursor: pointer;
      font-size: 0.875rem;
      transition: all 0.2s;
    }
    .nav-btn:hover {
      background: #f9fafb;
      border-color: var(--primary);
      color: var(--primary);
    }
    .nav-btn.today-btn {
      background: var(--primary);
      color: #ffffff;
      border-color: var(--primary);
    }
    .nav-btn.today-btn:hover {
      background: var(--primary-600);
    }
    .calendar-month,
    .week-range {
      font-size: 0.875rem;
      font-weight: 600;
      color: #111827;
      margin: 0;
    }
    .schedule-calendar {
      margin-top: 12px;
    }
    .calendar-weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 4px;
      margin-bottom: 8px;
    }
    .weekday {
      text-align: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: #6b7280;
      padding: 8px;
    }
    .calendar-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 4px;
    }
    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      justify-content: flex-start;
      padding: 8px 4px;
      border-radius: 8px;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
      border: 2px solid #e5e7eb;
      background: #ffffff;
      position: relative;
      min-height: 60px;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }
    .calendar-day:active {
      transform: scale(0.95);
      background: #f3f4f6;
    }
    .calendar-day:hover {
      background: #f9fafb;
      border-color: var(--primary);
    }
    .calendar-day.other-month {
      color: #d1d5db;
      background: #f9fafb;
      opacity: 0.6;
    }
    .calendar-day.today {
      background: var(--primary);
      color: #ffffff;
      font-weight: 700;
      border-color: var(--primary);
    }
    .calendar-day.today .calendar-day-number {
      color: #ffffff;
    }
    .calendar-day.selected {
      background: #dbeafe;
      border-color: #3b82f6;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
    }
    .calendar-day.has-event {
      border-color: #10b981;
      background: #f0fdf4;
    }
    .calendar-day.has-event.today {
      background: var(--primary);
      border-color: var(--primary);
    }
    .calendar-day-number {
      font-weight: 600;
      margin-bottom: 2px;
      font-size: 0.95rem;
    }
    .calendar-day-events {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-top: auto;
      padding-top: 4px;
    }
    .calendar-event-dot {
      width: 100%;
      height: 3px;
      background: #10b981;
      border-radius: 2px;
    }
    .calendar-event-count {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      background: #10b981;
      color: #ffffff;
      border-radius: 50%;
      font-size: 0.65rem;
      font-weight: 700;
      margin-top: 2px;
    }
    .calendar-day.today .calendar-event-count {
      background: rgba(255, 255, 255, 0.9);
      color: var(--primary);
    }
    /* Circular Component Styles */
    .circular-component-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 24px 0;
      padding: 20px;
    }
    .circular-component {
      position: relative;
      width: 100%;
      max-width: min(98vw, 98vh, 1000px);
      aspect-ratio: 1;
      margin: 0 auto;
      overflow: visible;
    }
    .circular-component-wrapper {
      overflow: visible;
      padding: 20px;
    }
    .circular-svg {
      width: 100%;
      height: 100%;
      transform: rotate(-90deg);
      transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      cursor: grab;
      user-select: none;
      -webkit-user-select: none;
    }
    .circular-svg:active {
      cursor: grabbing;
    }
    .circular-svg.dragging {
      transition: none;
    }
    /* Reference point indicator (0° position) */
    .reference-point {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 20px;
      background: #ef4444;
      border-radius: 2px;
      z-index: 10;
      pointer-events: none;
      box-shadow: 0 0 8px rgba(239, 68, 68, 0.6);
    }
    .circular-segment {
      cursor: pointer;
      transition: opacity 0.2s;
      fill: none;
      stroke-width: 16;
    }
    .circular-segment:hover {
      opacity: 0.9;
      stroke-width: 18;
    }
    .circular-segment.has-schedule:hover {
      filter: brightness(1.1);
    }
    /* Outer indicator circle (day indicators) */
    .day-indicator-segment {
      stroke-width: 16;
      stroke: #ffffff;
      pointer-events: none;
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
    }
    /* Border line for Saturday and Sunday */
    .day-border-line {
      stroke-width: 3;
      pointer-events: none;
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
    }
    .day-border-line.saturday {
      stroke: #BADFDB;
    }
    .day-border-line.sunday {
      stroke: #BF1A1A;
    }
    /* Inner schedule circle (schedule indicators) */
    .schedule-indicator-segment {
      stroke-width: 12;
      stroke: #ffb3d1;
      pointer-events: none;
    }
    /* Clickable segment overlay */
    .circular-segment {
      stroke-width: 16;
      stroke: transparent;
      fill: none;
      cursor: pointer;
    }
    .circular-segment:hover {
      stroke: rgba(255, 179, 209, 0.3);
    }
    .circular-segment.selected {
      stroke: rgba(220, 38, 38, 0.5);
      stroke-width: 18;
      filter: drop-shadow(0 0 4px rgba(220, 38, 38, 0.5));
    }
    .circular-segment.selected {
      stroke: #dc2626;
      stroke-width: 18;
      filter: drop-shadow(0 0 4px rgba(220, 38, 38, 0.5));
    }
    .circular-segment-label {
      font-size: 8px;
      fill: #374151;
      font-weight: 600;
      text-anchor: middle;
      dominant-baseline: middle;
    }
    .circular-segment-label.has-schedule {
      fill: #ffffff;
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    .circular-segment-label.no-schedule {
      fill: #6b7280;
    }
    .circular-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 50%;
      width: 180px;
      height: 180px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 12px;
      gap: 6px;
    }
    .center-day-of-week {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
      text-align: center;
      line-height: 1.2;
    }
    .center-date {
      font-size: 1rem;
      font-weight: 600;
      color: #111827;
      text-align: center;
      line-height: 1.2;
    }
    .center-schedule-count {
      font-size: 0.875rem;
      font-weight: 500;
      color: #6b7280;
      text-align: center;
      line-height: 1.2;
      margin-top: 4px;
    }
    .center-period {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      text-align: center;
      line-height: 1.2;
    }
    .center-time-range {
      font-size: 1rem;
      font-weight: 600;
      color: var(--primary);
      text-align: center;
      line-height: 1.2;
    }
    .circular-label {
      font-size: 1.25rem;
      font-weight: 700;
      color: #111827;
      margin-top: 8px;
      text-align: center;
    }
    .day-icon {
      font-size: 1.5rem;
      color: #fbbf24;
      margin: 4px;
      opacity: 0.3;
      transition: opacity 0.3s;
    }
    .day-icon.active {
      opacity: 1;
      color: #f59e0b;
    }
    #day-icon-moon {
      color: #6366f1;
    }
    #day-icon-moon.active {
      color: #4f46e5;
    }
    
    /* Day Period Toggle */
    .day-period-toggle {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      padding: 0 16px;
    }
    .period-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 20px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      background: #ffffff;
      color: #6b7280;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .period-btn:hover {
      border-color: var(--primary);
      color: var(--primary);
    }
    .period-btn.active {
      background: var(--primary);
      border-color: var(--primary);
      color: #ffffff;
    }
    .period-btn i {
      font-size: 1.25rem;
    }
    
    /* Circular Schedule List */
    .circular-schedule-list {
      margin-top: 24px;
      max-height: 400px;
      overflow-y: auto;
      padding: 0 4px;
    }
    .circular-schedule-list::-webkit-scrollbar {
      width: 6px;
    }
    .circular-schedule-list::-webkit-scrollbar-track {
      background: #f9fafb;
      border-radius: 3px;
    }
    .circular-schedule-list::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
    }
    .circular-schedule-list::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }
    .day-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding: 12px;
      background: #f9fafb;
      border-radius: 12px;
    }
    .day-date {
      font-size: 1.125rem;
      font-weight: 600;
      color: #111827;
      margin: 0;
    }
    .schedule-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .schedule-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 16px;
      background: #f9fafb;
      border-radius: 12px;
      border-left: 4px solid var(--primary);
      transition: all 0.2s;
    }
    .schedule-item:hover {
      background: #ffffff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .schedule-item.completed {
      border-left-color: #10b981;
      opacity: 0.7;
    }
    .item-date {
      min-width: 60px;
      text-align: center;
    }
    .date-day {
      display: block;
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
    }
    .date-dow {
      display: block;
      font-size: 0.75rem;
      color: #6b7280;
      margin-top: 2px;
    }
    .item-content {
      flex: 1;
      min-width: 0;
    }
    .item-time {
      font-weight: 600;
      color: var(--primary);
      font-size: 1rem;
      margin-bottom: 6px;
    }
    .item-client {
      font-weight: 600;
      color: #111827;
      font-size: 0.95rem;
      margin-bottom: 4px;
    }
    .item-store {
      font-size: 0.875rem;
      color: #6b7280;
      margin-bottom: 4px;
    }
    .item-purpose {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      background: #dbeafe;
      color: #1e40af;
      font-size: 0.75rem;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .item-address {
      font-size: 0.875rem;
      color: #6b7280;
      margin-bottom: 8px;
    }
    .item-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .action-btn {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid #e5e7eb;
      background: #ffffff;
      color: #374151;
      font-size: 0.75rem;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.2s;
    }
    .action-btn:hover {
      border-color: var(--primary);
      color: var(--primary);
    }
    .action-btn.map-btn {
      border-color: #10b981;
      color: #10b981;
    }
    .action-btn.map-btn:hover {
      background: #10b981;
      color: #ffffff;
    }
    .action-btn.edit-btn {
      border-color: var(--primary);
      color: var(--primary);
    }
    .action-btn.edit-btn:hover {
      background: var(--primary);
      color: #ffffff;
    }
    .action-btn.delete-btn {
      border-color: #ef4444;
      color: #ef4444;
    }
    .action-btn.delete-btn:hover {
      background: #ef4444;
      color: #ffffff;
    }
    .action-btn.complete-btn {
      border-color: #10b981;
      color: #10b981;
    }
    .action-btn.complete-btn:hover {
      background: #10b981;
      color: #ffffff;
    }
    .history-filter {
      margin-bottom: 20px;
    }
    .filter-select {
      width: 100%;
      padding: 10px 16px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      background: #ffffff;
      font-size: 0.875rem;
      color: #374151;
    }
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: #ffffff;
      border-radius: 12px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      border-bottom: 1px solid #e5e7eb;
    }
    .modal-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: #111827;
      margin: 0;
    }
    .modal-close {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: #f9fafb;
      color: #6b7280;
      cursor: pointer;
      transition: all 0.2s;
    }
    .modal-close:hover {
      background: #e5e7eb;
      color: #111827;
    }
    .form-group {
      margin-bottom: 20px;
      padding: 0 20px;
    }
    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 600;
      color: #374151;
      margin-bottom: 6px;
    }
    .form-label .required {
      color: #ef4444;
    }
    .form-input,
    .form-textarea {
      width: 100%;
      padding: 10px 16px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      font-size: 0.875rem;
      color: #374151;
      transition: all 0.2s;
    }
    .form-input:focus,
    .form-textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 103, 156, 0.1);
    }
    .form-textarea {
      resize: vertical;
    }
    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      padding: 20px;
      border-top: 1px solid #e5e7eb;
    }
    .form-actions .btn {
      padding: 10px 20px;
      font-size: 0.875rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-danger {
      background: #ef4444;
      color: #ffffff;
      border: none;
    }
    .btn-danger:hover {
      background: #dc2626;
    }
    .hidden {
      display: none !important;
    }
    @media (max-width: 768px) {
      .sales-schedule {
        padding: 12px;
      }
      .view-container {
        padding: 12px;
      }
      .calendar-nav {
        padding: 8px;
        gap: 8px;
      }
      .nav-btn {
        padding: 8px 12px;
        font-size: 0.8rem;
        min-width: 44px;
        min-height: 44px;
      }
      .calendar-month {
        font-size: 1rem;
      }
      .calendar-day {
        font-size: 0.8rem;
        padding: 6px 3px;
        min-height: 50px;
        border-width: 1.5px;
      }
      .calendar-day-number {
        font-size: 0.85rem;
      }
      .calendar-event-dot {
        height: 2px;
      }
      .calendar-event-count {
        width: 16px;
        height: 16px;
        font-size: 0.6rem;
      }
      .weekday {
        font-size: 0.7rem;
        padding: 6px 4px;
      }
      .schedule-item {
        flex-direction: column;
        gap: 12px;
      }
      .item-date {
        min-width: auto;
        text-align: left;
      }
      .item-actions {
        width: 100%;
      }
      .action-btn {
        flex: 1;
        justify-content: center;
        min-height: 44px;
        padding: 10px 16px;
        font-size: 0.875rem;
      }
      .modal-content {
        max-width: 100%;
        max-height: 100vh;
        border-radius: 0;
      }
      .selected-date-schedules {
        margin-top: 16px;
        padding: 12px;
      }
      /* SP: 円形コンポーネントを独立して大きく表示 */
      .circular-component-wrapper {
        margin: 16px -12px;
        padding: 16px;
        width: calc(100% + 24px);
        max-width: 100vw;
      }
      .circular-component {
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        height: auto !important;
        aspect-ratio: 1;
        margin: 0 auto;
      }
      .circular-svg {
        width: 100% !important;
        height: 100% !important;
        max-width: 100% !important;
      }
      .circular-label {
        font-size: 1rem;
      }
      .center-day-of-week {
        font-size: 1.5rem;
      }
      .center-date {
        font-size: 0.875rem;
      }
      .center-schedule-count {
        font-size: 0.75rem;
      }
      .center-period {
        font-size: 1.25rem;
      }
      .center-time-range {
        font-size: 0.875rem;
      }
      .circular-center {
        width: 150px;
        height: 150px;
      }
      .day-period-toggle {
        padding: 0 8px;
      }
      .period-btn {
        padding: 10px 16px;
        font-size: 0.875rem;
      }
      .circular-schedule-list {
        max-height: 300px;
      }
    }
  </style>

  <script type="application/json" id="schedule-data">{"schedules": [{"id": 1, "date": "2025-11-23", "time": "09:00", "client_name": "株式会社ABC", "store_name": "ABC店", "purpose": "定期清掃", "address": "東京都渋谷区1-1-1", "phone": "03-1234-5678", "email": "abc@example.com", "status": "pending"}, {"id": 2, "date": "2025-11-23", "time": "14:00", "client_name": "株式会社XYZ", "store_name": "XYZ店", "purpose": "エアコン清掃", "address": "東京都新宿区2-2-2", "phone": "03-2345-6789", "email": "xyz@example.com", "status": "pending"}, {"id": 3, "date": "2025-11-24", "time": "10:00", "client_name": "株式会社DEF", "store_name": "DEF店", "purpose": "害虫駆除", "address": "東京都港区3-3-3", "phone": "03-3456-7890", "email": "def@example.com", "status": "pending"}, {"id": 4, "date": "2025-11-24", "time": "15:00", "client_name": "株式会社GHI", "store_name": "GHI店", "purpose": "定期清掃", "address": "東京都品川区4-4-4", "phone": "03-4567-8901", "email": "ghi@example.com", "status": "pending"}, {"id": 5, "date": "2025-11-25", "time": "08:00", "client_name": "株式会社JKL", "store_name": "JKL店", "purpose": "床清掃", "address": "東京都目黒区5-5-5", "phone": "03-5678-9012", "email": "jkl@example.com", "status": "pending"}, {"id": 6, "date": "2025-11-25", "time": "13:00", "client_name": "株式会社MNO", "store_name": "MNO店", "purpose": "トイレ清掃", "address": "東京都世田谷区6-6-6", "phone": "03-6789-0123", "email": "mno@example.com", "status": "pending"}, {"id": 7, "date": "2025-11-25", "time": "18:00", "client_name": "株式会社PQR", "store_name": "PQR店", "purpose": "定期清掃", "address": "東京都大田区7-7-7", "phone": "03-7890-1234", "email": "pqr@example.com", "status": "pending"}, {"id": 8, "date": "2025-11-26", "time": "11:00", "client_name": "株式会社STU", "store_name": "STU店", "purpose": "エアコン清掃", "address": "東京都杉並区8-8-8", "phone": "03-8901-2345", "email": "stu@example.com", "status": "pending"}, {"id": 9, "date": "2025-11-26", "time": "16:00", "client_name": "株式会社VWX", "store_name": "VWX店", "purpose": "害虫駆除", "address": "東京都中野区9-9-9", "phone": "03-9012-3456", "email": "vwx@example.com", "status": "pending"}, {"id": 10, "date": "2025-11-27", "time": "09:30", "client_name": "株式会社YZA", "store_name": "YZA店", "purpose": "定期清掃", "address": "東京都練馬区10-10-10", "phone": "03-0123-4567", "email": "yza@example.com", "status": "pending"}, {"id": 11, "date": "2025-11-27", "time": "14:30", "client_name": "株式会社BCD", "store_name": "BCD店", "purpose": "床清掃", "address": "東京都板橋区11-11-11", "phone": "03-1234-5678", "email": "bcd@example.com", "status": "pending"}, {"id": 12, "date": "2025-11-28", "time": "10:30", "client_name": "株式会社EFG", "store_name": "EFG店", "purpose": "トイレ清掃", "address": "東京都北区12-12-12", "phone": "03-2345-6789", "email": "efg@example.com", "status": "pending"}, {"id": 13, "date": "2025-11-28", "time": "15:30", "client_name": "株式会社HIJ", "store_name": "HIJ店", "purpose": "エアコン清掃", "address": "東京都豊島区13-13-13", "phone": "03-3456-7890", "email": "hij@example.com", "status": "pending"}, {"id": 14, "date": "2025-11-28", "time": "20:00", "client_name": "株式会社KLM", "store_name": "KLM店", "purpose": "定期清掃", "address": "東京都文京区14-14-14", "phone": "03-4567-8901", "email": "klm@example.com", "status": "pending"}]}</script>
  <script type="application/json" id="clients-data">{"clients": [{"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's )", "store_name": "日本橋茅場町店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月19日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "2167ccb6"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's )", "store_name": "大塚店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月20日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "bf9f6bcc"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's", "store_name": "高円寺店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月21日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "703bafc0"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's", "store_name": "水道橋店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月11日 7:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "d5da5132"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's", "store_name": "神楽坂店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月11日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "86cce202"}, {"company_name": "株式会社 GRAST", "company_name_kana": "", "brand_name": "手作りの味噌らーめん", "store_name": "味噌樽", "contact_person": "和田 賢次@渡邉社長紹介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b94abbdc"}, {"company_name": "株式会社 GRAST", "company_name_kana": "", "brand_name": "北海道らーめん みそ熊", "store_name": "北千住店", "contact_person": "和田 賢次@渡邉社長紹介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "afeceb88"}, {"company_name": "株式会社 GRAST", "company_name_kana": "", "brand_name": "北海道らーめん みそ熊", "store_name": "王子店", "contact_person": "和田 賢次@渡邉社長紹介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "a0d05c48"}, {"company_name": "株式会社 SSG", "company_name_kana": "", "brand_name": "上海料理佳樹園", "store_name": "", "contact_person": "砂子田社長", "email": "", "sales_rep": "正田和輝", "store_count": "1店舗", "status": "稼働中", "notes": "4月から月2　グリストラップ清掃＋α", "next_date": "", "url": "", "cleaning_frequency": "２週間に１回", "id": "83816a1c"}, {"company_name": "株式会社 ゴーゴーカレーグループ", "company_name_kana": "", "brand_name": "ゴーゴーカレー", "store_name": "新宿東口駅前スタジアム", "contact_person": "松永", "email": "ksms.matsunaga@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "33d1da77"}, {"company_name": "株式会社2M8", "company_name_kana": "", "brand_name": "MASSIMOTTVIO", "store_name": "", "contact_person": "角谷店長", "email": "saigonkitchien@dedesuke.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "65f8ddef"}, {"company_name": "株式会社Bright", "company_name_kana": "", "brand_name": "貸切居酒屋ラフェス", "store_name": "神田小川町店", "contact_person": "大江　ひとみ", "email": "", "sales_rep": "佐藤大志", "store_count": "", "status": "稼働中", "notes": "3月11日水道蛇口交換工事の依頼。外注合わせて60,000円のニーズがありました。その他に害虫害虫が気になるとのことで今後依頼する可能性あり。売り上げ的には至っていないが、今イベント活動しているため、今後フリーストラップ、床清掃などの提案し依頼される可能性あり", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b5c24939"}, {"company_name": "株式会社CatchBall", "company_name_kana": "", "brand_name": "ラム肉専門店-隣のロッヂ", "store_name": "", "contact_person": "松倉", "email": "t.matsukura@hitsujinolodge.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "7/7 　清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1d895c6c"}, {"company_name": "株式会社CatchBall", "company_name_kana": "", "brand_name": "ようさい", "store_name": "", "contact_person": "松倉", "email": "t.matsukura@hitsujinolodge.com", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1d895c6c"}, {"company_name": "株式会社FELICE", "company_name_kana": "", "brand_name": "宮崎辛麺　辛麺屋一輪", "store_name": "", "contact_person": "幸谷 仁志", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "スポット依頼", "next_date": "", "url": "", "cleaning_frequency": "", "id": "a91ee1dc"}, {"company_name": "株式会社GOSSO", "company_name_kana": "", "brand_name": "0秒レモンサワー 仙台ホルモン焼肉酒場 ときわ亭", "store_name": "渋谷店", "contact_person": "國吉さん", "email": "kuniyoshi@gosso.co.jp", "sales_rep": "正田和輝", "store_count": "60店舗", "status": "稼働中", "notes": "定期清掃　月75,000円", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "1336062b"}, {"company_name": "株式会社GOSSO", "company_name_kana": "", "brand_name": "CRAFTCHEESEMARKET", "store_name": "渋谷店", "contact_person": "高橋", "email": "takahashi_t@gosso.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "38a66680"}, {"company_name": "株式会社GRAST", "company_name_kana": "", "brand_name": "北海道らーめん みそ熊", "store_name": "王子店", "contact_person": "桑原政之", "email": "masayuki_kuwabara@mulbelea.co.jp", "sales_rep": "", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f006e997"}, {"company_name": "株式会社HIRA", "company_name_kana": "", "brand_name": "SUNRIZE", "store_name": "大崎店", "contact_person": "ラミチャネ スリヤ", "email": "suryalami123 @gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "商談済", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f61011d7"}, {"company_name": "株式会社INGS", "company_name_kana": "", "brand_name": "CONA 千葉駅前店", "store_name": "", "contact_person": "FC菅又さん", "email": "", "sales_rep": "佐藤大志", "store_count": "", "status": "契約作業中", "notes": "ビーエヌアイ村友さんからのご紹介。千葉の駅前にあるイタリアンのお店クリス。トラップ、ダクト清掃など含めて複数依頼あり。店舗差はこれから実施する。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "059c922e"}, {"company_name": "株式会社Next Culture", "company_name_kana": "", "brand_name": "BAR　FD", "store_name": "", "contact_person": "かおん", "email": "", "sales_rep": "林大貴（浅倉麗央）", "store_count": "", "status": "稼働中", "notes": "ゴミ回収", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9a8c9062"}, {"company_name": "株式会社PET’S MOST", "company_name_kana": "", "brand_name": "inu to hito", "store_name": "", "contact_person": "遠藤", "email": "inutohito0712@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d196d7bc"}, {"company_name": "株式会社Plan・Do・See", "company_name_kana": "", "brand_name": "THE MARK GRAND HOTEL", "store_name": "", "contact_person": "関根", "email": "eriko.sekine@themarkgrand.com", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "8481c94b"}, {"company_name": "株式会社wege", "company_name_kana": "", "brand_name": "KUSABIオフィス", "store_name": "", "contact_person": "りょう（永井研行）", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "検討中", "notes": "1年契約が終了するタイミング。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1df0457b"}, {"company_name": "株式会社ZANGIRI", "company_name_kana": "", "brand_name": "ZANGIRI Next", "store_name": "", "contact_person": "大平社長", "email": "", "sales_rep": "正田和輝", "store_count": "2店舗", "status": "稼働中", "notes": "4月エアコン分解清掃", "next_date": "", "url": "", "cleaning_frequency": "年１清掃", "id": "55d57c2d"}, {"company_name": "株式会社アシュリップ", "company_name_kana": "", "brand_name": "カイロライン", "store_name": "国分寺整体院", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f9a6fd67"}, {"company_name": "株式会社いのこ", "company_name_kana": "", "brand_name": "麺処いのこ", "store_name": "赤塚店", "contact_person": "阿部店長", "email": "ossan.t2@ezweb.ne.jp", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "8e67aaa6"}, {"company_name": "株式会社いのこ", "company_name_kana": "", "brand_name": "麺処いのこ", "store_name": "平和台店", "contact_person": "見留太基店長", "email": "gullwing8864@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "75fedfcd"}, {"company_name": "株式会社エゴイプセ", "company_name_kana": "", "brand_name": "大勝軒", "store_name": "大勝軒まるいち 新宿東南口店", "contact_person": "松永誠一", "email": "ksms.matsunaga@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "31aaa93e"}, {"company_name": "株式会社エデュケーション", "company_name_kana": "", "brand_name": "モンキーツリー", "store_name": "", "contact_person": "鈴木社長", "email": "rsa44186@gmail.com", "sales_rep": "正田和輝", "store_count": "1店舗", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "dc0c7082"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚焼男", "store_name": "弐", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "3ec1b358"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚豪商", "store_name": "コダマ新橋店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "54b66e34"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚焼男", "store_name": "新橋本店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1e832dc3"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "焼肉男", "store_name": "マンモス", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "ccaeb2ed"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚無双", "store_name": "トオダ", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b1701651"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚豪商コダマ", "store_name": "錦糸町店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "77cd1d5a"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚豪商コダマ", "store_name": "大井町店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "0f8748eb"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "燻男（いぶしお）", "store_name": "", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "78c7baf0"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "ホルモンのマンモス", "store_name": "", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "78c7baf0"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "新魚焼男", "store_name": "ニューサカナヤキオ", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d3b726d3"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "新燻男", "store_name": "ニューイブシオ", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "543c4515"}, {"company_name": "株式会社がっと", "company_name_kana": "", "brand_name": "ワイン食堂がっと", "store_name": "渋谷円山町店", "contact_person": "佐藤 大介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "2月レンジフードダクト清掃（3万）、5月エアコン分解洗浄、室外機もやりたい", "next_date": "2025年3月19日 7:00", "url": "https://x.gd/IKIiK", "cleaning_frequency": "年１清掃", "id": "0f4557a9"}, {"company_name": "株式会社カワイハイ", "company_name_kana": "", "brand_name": "ニクアザブ", "store_name": "西麻布店", "contact_person": "夕島店長", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "防火扉がしまっていて、左側のキーボックス 0877", "next_date": "", "url": "", "cleaning_frequency": "", "id": "98a40e3b"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "早稲田総本店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "a298df02"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "早稲田別館", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "eb276c6d"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "明大前", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "60c1653e"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "代々木店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "81641448"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "吉祥寺店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "6737de36"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "神田店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "検討中", "notes": "フランチャイズでグリストラップとエアコン洗浄を依頼したい", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9f84ba3a"}, {"company_name": "株式会社クラフトマスタージャパン", "company_name_kana": "", "brand_name": "鮨 輝らく", "store_name": "", "contact_person": "堀題地", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "見積書送付", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9c10049e"}, {"company_name": "株式会社しゃぶ庵", "company_name_kana": "", "brand_name": "一見さんお断り 完全会員制 お座敷遊び 料亭 「独楽」", "store_name": "", "contact_person": "福田誠治", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "西麻布のBAR、金龍、独楽をやっている。", "next_date": "", "url": "https://x.gd/zwmhm", "cleaning_frequency": "", "id": "c25dbcb3"}, {"company_name": "株式会社ストラク", "company_name_kana": "", "brand_name": "焼肉商店 浦島屋 津田沼店", "store_name": "", "contact_person": "FC菅又さん", "email": "m-sugamata@springs-web.com", "sales_rep": "佐藤大志", "store_count": "", "status": "契約作業中", "notes": "ビーエヌI村友さんからのご紹介。津田沼駅にある焼肉店のご依頼ホール内に複数の天井から通されている。ダクトあり。その他油まみれな部分があるため清掃依頼あり", "next_date": "", "url": "", "cleaning_frequency": "", "id": "7831fc54"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "オイスター&珍味 bar 不夜城", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "ディストピアBar KARMA　カルマ", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "Japanese Bar　猪鹿蝶", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "Bar ANIME HOLIC アニメホリック goldengai", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "Bar 灯鏡 tokyo 歌舞伎町レッドのれん街", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社ダイニングエッジ", "company_name_kana": "", "brand_name": "楽が気", "store_name": "新橋本店", "contact_person": "黒沢 幸樹", "email": "koki-kurosawa@diningedge.co.jp", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "26bf2a5d"}, {"company_name": "株式会社ダイニング富士屋本店", "company_name_kana": "", "brand_name": "富士屋本店", "store_name": "日本橋浜町", "contact_person": "加藤雄三", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "94f76013"}, {"company_name": "株式会社ダイニング富士屋本店", "company_name_kana": "", "brand_name": "立呑 富士屋本店", "store_name": "立呑 富士屋本店", "contact_person": "酒主", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "c7fe22ba"}, {"company_name": "株式会社ダイニング富士屋本店", "company_name_kana": "", "brand_name": "富士屋本店", "store_name": "日本橋浜町", "contact_person": "", "email": "", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "24305c2b"}, {"company_name": "株式会社テイクユー", "company_name_kana": "", "brand_name": "貝出汁 中華そば 竹祥", "store_name": "", "contact_person": "中村", "email": "yuichi@muse-sava.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "707918f1"}, {"company_name": "株式会社デイジイ", "company_name_kana": "", "brand_name": "株式会社デイジイ", "store_name": "西新宿店", "contact_person": "倉田尚子常務取締役", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "266fe182"}, {"company_name": "株式会社デイジイ", "company_name_kana": "", "brand_name": "株式会社デイジイ", "store_name": "麹町店", "contact_person": "倉田尚子常務取締役", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "50509a58"}, {"company_name": "株式会社でですけ", "company_name_kana": "", "brand_name": "でですけサイゴンキッチン", "store_name": "", "contact_person": "小原店長", "email": "", "sales_rep": "正田和輝", "store_count": "8店舗", "status": "稼働中", "notes": "エアコン清掃依頼　遠藤さんが獲得、営業案件", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "cc9d3593"}, {"company_name": "株式会社ニュートン", "company_name_kana": "", "brand_name": "カラオケパセラ", "store_name": "上野駅前店", "contact_person": "根本 諭", "email": "hiraoka@newton-co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "6ff89ce9"}, {"company_name": "株式会社ニュートン", "company_name_kana": "", "brand_name": "カラオケパセラ", "store_name": "上野御徒町店", "contact_person": "根本 諭", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "5029e8c1"}, {"company_name": "株式会社パズルフードサービス", "company_name_kana": "", "brand_name": "東京餃子楼", "store_name": "三軒茶屋本店", "contact_person": "齋藤部長　奥村啓社長", "email": "food@puzzle-ring.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "7d9b5321"}, {"company_name": "株式会社パズルフードサービス", "company_name_kana": "", "brand_name": "東京餃子楼", "store_name": "工場", "contact_person": "齋藤部長　奥村啓社長", "email": "food@puzzle-ring.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "隔月清掃", "id": "4ed53c81"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ホルモン屋 だん", "store_name": "新橋総本店", "contact_person": "三浦さん（渡辺社長）", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b88fd428"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ホルモン屋 だん", "store_name": "新橋2号店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "2e3fe061"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ホルモン屋 だん", "store_name": "はなれ新橋3号店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "33e6a3c3"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "生ラムかんな", "store_name": "新橋店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "325a8b56"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ラムと泡", "store_name": "本店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "15bc6988"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "肉汁屋", "store_name": "新橋店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "325a8b56"}, {"company_name": "株式会社フードアンドパートナーズ", "company_name_kana": "", "brand_name": "発酵デリカテッセンカフェテリアKouji&ko", "store_name": "", "contact_person": "高野伴美（高橋真樹）", "email": "takahashi-maki@foodandpartners.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "渋谷と新宿のテナントに入居中", "next_date": "", "url": "https://x.gd/c4Ern", "cleaning_frequency": "3ヶ月に1回清掃", "id": "0ad5d6bf"}, {"company_name": "株式会社フードアンドパートナーズ", "company_name_kana": "", "brand_name": "発酵デリカテッセン カフェテリアKouji&ko", "store_name": "", "contact_person": "高橋部長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "３ヶ月に1回清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "78449035"}, {"company_name": "株式会社マッスルボディメイク", "company_name_kana": "", "brand_name": "マッスルボディメイク", "store_name": "", "contact_person": "吉成題寿", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "パーソナルジム", "next_date": "", "url": "https://x.gd/4O2gk", "cleaning_frequency": "スポット清掃", "id": "ddbce584"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炉端居酒屋", "store_name": "中野製作所 まんてん別館", "contact_person": "真船店長（阿部社長）", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "ゴキブリ駆除依頼", "next_date": "2025年3月21日 13:00", "url": "", "cleaning_frequency": "スポット清掃", "id": "4328c02c"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炭火焼きホルモンまんてん", "store_name": "中野店", "contact_person": "村上店長（阿部社長）", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "・ゴキブリ", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9afccec8"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炭火焼きホルモンまんてん", "store_name": "中目黒本店", "contact_person": "はづき", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "古い店なのでそこそこ汚れはあるんですが、子バエがいるのが気になりますね", "next_date": "2025年3月28日 10:30", "url": "", "cleaning_frequency": "毎月清掃", "id": "254bf36f"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炭火焼きホルモンまんてん", "store_name": "代々木店", "contact_person": "神棒智", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "ダクト清掃", "next_date": "2025年3月28日 10:30", "url": "", "cleaning_frequency": "毎月清掃", "id": "27cff7c3"}, {"company_name": "株式会社ラムラ", "company_name_kana": "", "brand_name": "すし土風炉", "store_name": "登戸店", "contact_person": "", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "0a3b06ee"}, {"company_name": "株式会社価値作り研究所", "company_name_kana": "", "brand_name": "ステーキロッジ", "store_name": "道元坂店", "contact_person": "福田幸洋", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "https://x.gd/Ntu4u", "cleaning_frequency": "", "id": "703690b5"}, {"company_name": "株式会社価値作り研究所", "company_name_kana": "", "brand_name": "ステーキロッヂ ヨドバシ", "store_name": "Akiba店", "contact_person": "福田幸洋", "email": "", "sales_rep": "正田和輝", "store_count": "数店舗", "status": "契約作業中", "notes": "", "next_date": "", "url": "https://x.gd/7g4sW", "cleaning_frequency": "", "id": "c22b7491"}, {"company_name": "株式会社元気Dining", "company_name_kana": "", "brand_name": "大衆寿司酒場こがね", "store_name": "", "contact_person": "永井部長", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f540557f"}, {"company_name": "株式会社元気Dining", "company_name_kana": "", "brand_name": "大衆焼肉酒場こがね", "store_name": "", "contact_person": "永井部長", "email": "nagai.r.genki@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f540557f"}, {"company_name": "株式会社小肥羊ジャパン", "company_name_kana": "", "brand_name": "火鍋 小肥羊", "store_name": "銀座店", "contact_person": "梶原部長", "email": "", "sales_rep": "正田和輝", "store_count": "20店舗", "status": "稼働中", "notes": "ネズミ駆除、6月〜7月、撲滅してから考える。", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "868b43b1"}, {"company_name": "株式会社千寿菊", "company_name_kana": "", "brand_name": "新橋バーラウンジ御殿", "store_name": "", "contact_person": "鈴木真理子", "email": "", "sales_rep": "林大貴（浅倉麗央）", "store_count": "", "status": "稼働中", "notes": "グリストラップ エアコンフィルター 厨房フィルター 害虫駆除 厨房機器掻き出し シンクの臭い除去 シンク清掃 初回50,000円", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d5d6c028"}, {"company_name": "株式会社馬力　神田店", "company_name_kana": "", "brand_name": "馬力", "store_name": "馬力 神田南口店", "contact_person": "渡邉", "email": "bariki.group@ezweb.ne.jp", "sales_rep": "沖 智弘", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "4a310e3d"}, {"company_name": "株式会社名店館", "company_name_kana": "", "brand_name": "ビストロ エヴォルテ", "store_name": "", "contact_person": "木ノ内 謙", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "https://x.gd/nUWrX", "cleaning_frequency": "3ヶ月に1回清掃", "id": "7f2539db"}, {"company_name": "株式会社友電設", "company_name_kana": "", "brand_name": "Mahaloh Import Shop", "store_name": "", "contact_person": "ウィリアン", "email": "Willianmahalohjp@hotmail.com", "sales_rep": "梅岡Alexandra", "store_count": "1", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "373e4c83"}, {"company_name": "株式会社雷神", "company_name_kana": "", "brand_name": "油そば 雷神", "store_name": "市川店", "contact_person": "加藤陸王　（加藤 裕之）", "email": "goku.kato@raijin-gyouza.jp", "sales_rep": "正田和輝", "store_count": "1店舗", "status": "契約作業中", "notes": "柏　6月1日から開始", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1afaa333"}, {"company_name": "居酒屋ビッグ 新河岸駅前店", "company_name_kana": "", "brand_name": "居酒屋ビッグ", "store_name": "新河岸駅前店", "contact_person": "神宮　将", "email": "js.bar.54fg@gmail.com", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "668ca5b2"}, {"company_name": "御座敷天婦羅　神楽坂 天孝", "company_name_kana": "", "brand_name": "御座敷天婦羅　神楽坂 天孝", "store_name": "", "contact_person": "新井　均", "email": "h.arai@kagurasaka-tenko.jp", "sales_rep": "遠藤虹輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "afb44227"}, {"company_name": "合同会社FOOD GROOVE JAPAN", "company_name_kana": "", "brand_name": "米と魚　さかなさま", "store_name": "", "contact_person": "酒井（鈴木基次）", "email": "info.foodgroovejapan@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "末日ゴミ回収＋見積もりの内容", "next_date": "2025年3月28日 0:00", "url": "https://x.gd/UneyL", "cleaning_frequency": "", "id": "ff399963"}, {"company_name": "合同会社FOOD GROOVE JAPAN", "company_name_kana": "", "brand_name": "麺と肴　担々麺 ペン坊", "store_name": "", "contact_person": "青柳昇店長(さかなさまスタッフ)", "email": "noboru.ao@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "レンジフードのグリスフィルターがない。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d4cf599b"}, {"company_name": "合同会社SKTC", "company_name_kana": "", "brand_name": "Aphrodite　アフロディーテ（ニューハーフバー）", "store_name": "", "contact_person": "岩下 弥樹", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "3月清掃", "next_date": "", "url": "https://x.gd/LdNvl", "cleaning_frequency": "スポット清掃", "id": "e2508de7"}, {"company_name": "合同会社TRANSAM", "company_name_kana": "", "brand_name": "dining Bar TRANSAM赤坂", "store_name": "", "contact_person": "宮西宏嘉", "email": "", "sales_rep": "佐藤大志", "store_count": "1", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "930ccaef"}, {"company_name": "合同会社港エージェンシー", "company_name_kana": "", "brand_name": "西麻布ZERO", "store_name": "", "contact_person": "福田誠治", "email": "", "sales_rep": "正田和輝", "store_count": "2,3,4階", "status": "契約作業中", "notes": "定期清掃 10万（床/ソファ/カーペット/エアコンフィルター）", "next_date": "", "url": "", "cleaning_frequency": "", "id": "82e64aee"}, {"company_name": "合同会社港エージェンシー", "company_name_kana": "", "brand_name": "西麻布カラオケCLT", "store_name": "", "contact_person": "福田誠治", "email": "", "sales_rep": "正田和輝", "store_count": "6階１店舗", "status": "契約作業中", "notes": "6階 5万", "next_date": "", "url": "", "cleaning_frequency": "", "id": "82e64aee"}, {"company_name": "焼肉 松の屋", "company_name_kana": "", "brand_name": "焼肉 松の屋", "store_name": "焼肉 松の屋", "contact_person": "岩渕", "email": "t.iwabuchi-74@sp-nur.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "7fdb0819"}, {"company_name": "板前寿司ジャパン", "company_name_kana": "", "brand_name": "板前寿司", "store_name": "赤坂店", "contact_person": "月木専務", "email": "tsukigi@itamae.co.jp", "sales_rep": "正田和輝", "store_count": "8店舗", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f26f4f31"}, {"company_name": "板前寿司ジャパン", "company_name_kana": "", "brand_name": "板前寿司", "store_name": "愛宕店", "contact_person": "月木専務", "email": "tsukigi@itamae.co.jp", "sales_rep": "正田和輝", "store_count": "8店舗", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "4868fa83"}, {"company_name": "有限会社タカネット", "company_name_kana": "", "brand_name": "ロケ弁エージェント", "store_name": "", "contact_person": "高杉光徳", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "ロケ弁の店舗三ノ輪で４店舗ある。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "990a563e"}, {"company_name": "", "company_name_kana": "", "brand_name": "たまき新宿2代目店", "store_name": "たまき新宿2代目店", "contact_person": "グルン", "email": "gbu4991@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "ada1ef3f"}, {"company_name": "", "company_name_kana": "", "brand_name": "韓国料理COCOYA", "store_name": "池袋2号店", "contact_person": "", "email": "", "sales_rep": "", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "58ca79e3"}, {"company_name": "", "company_name_kana": "", "brand_name": "創作イタリアン肉バル スオーノ", "store_name": "", "contact_person": "能勢 純司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "グリースサットルで床も荒れ放題", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc2ac60e"}, {"company_name": "", "company_name_kana": "", "brand_name": "リストランティアーノ　　ルベロ", "store_name": "", "contact_person": "長澤流（竹中社長）", "email": "", "sales_rep": "正田和輝", "store_count": "1", "status": "契約作業中", "notes": "", "next_date": "", "url": "https://x.gd/nCFom", "cleaning_frequency": "", "id": "6c3b4e4b"}, {"company_name": "", "company_name_kana": "", "brand_name": "CRAFT CHEESE MARKET", "store_name": "渋谷駅前店", "contact_person": "", "email": "", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "3314df61"}, {"company_name": "", "company_name_kana": "", "brand_name": "デニーロ", "store_name": "デニーロ神田店", "contact_person": "今村店長", "email": "shinpei9600@gmail.com", "sales_rep": "正田和輝", "store_count": "2店舗", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "a71e8c2c"}, {"company_name": "", "company_name_kana": "", "brand_name": "FAST OYSTERS", "store_name": "神楽坂店", "contact_person": "渡邉社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "950883e3"}, {"company_name": "", "company_name_kana": "", "brand_name": "WAGYU SUKIYAKI 極〜GOKU〜", "store_name": "東銀座築地", "contact_person": "浦 昴大", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b5c0e18c"}, {"company_name": "", "company_name_kana": "", "brand_name": "家庭料理居酒屋　焼肉Yakitaro", "store_name": "水道橋店", "contact_person": "秋元賢", "email": "yakitaro5215@ezweb.ne.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "36010174"}], "total": 114}</script>
  
  <script>
    (function() {
      // Load data
      const scheduleData = JSON.parse(document.getElementById('schedule-data').textContent);
      const clientsData = JSON.parse(document.getElementById('clients-data').textContent);
      
      // Store schedules in memory (in real app, this would be from API)
      let schedules = scheduleData.schedules || [];
      let history = []; // Completed schedules
      
      // Calendar state
      let currentDate = new Date();
      let currentView = 'month';
      let selectedDate = null;
      let selectedDayOfWeek = null; // For week view
      let selectedDayOfMonth = null; // For month view
      let selectedTimePeriod = 'morning'; // For day view: 'morning' or 'afternoon'
      let selectedTimeSlot = null; // For day view: specific time slot
      
      // Rotation state
      let isDragging = false;
      let rotationAngle = 0; // Current rotation angle in degrees
      let startRotationAngle = 0; // Rotation angle when drag started
      let dragStartAngle = 0; // Mouse/touch angle when drag started
      let currentSvg = null; // Currently active SVG element
      let rotationHandlersSetup = new Set(); // Track which SVGs have handlers set up
      let minDragDistance = 5; // Minimum drag distance in pixels to start rotation
      let dragStartPoint = null; // Starting point for drag distance calculation
      
      // Swipe detection for calendar
      let touchStartX = 0;
      let touchEndX = 0;
      let isSwipeEnabled = true;
      
      // Initialize
      init();
      
      function init() {
        // View tabs
        document.querySelectorAll('.view-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            const view = tab.dataset.view;
            switchView(view);
          });
        });
        
        // Calendar navigation
        document.getElementById('prev-month').addEventListener('click', () => {
          currentDate.setMonth(currentDate.getMonth() - 1);
          renderMonthView();
        });
        document.getElementById('next-month').addEventListener('click', () => {
          currentDate.setMonth(currentDate.getMonth() + 1);
          renderMonthView();
        });
        document.getElementById('today-month').addEventListener('click', () => {
          currentDate = new Date();
          renderMonthView();
        });
        
        // Week navigation
        document.getElementById('prev-week').addEventListener('click', () => {
          currentDate.setDate(currentDate.getDate() - 7);
          renderWeekView();
        });
        document.getElementById('next-week').addEventListener('click', () => {
          currentDate.setDate(currentDate.getDate() + 7);
          renderWeekView();
        });
        document.getElementById('today-week').addEventListener('click', () => {
          currentDate = new Date();
          renderWeekView();
        });
        
        // Modal
        const modalClose = document.getElementById('modal-close');
        if (modalClose) {
          modalClose.addEventListener('click', closeScheduleModal);
        }
        const modalCancel = document.getElementById('modal-cancel');
        if (modalCancel) {
          modalCancel.addEventListener('click', closeScheduleModal);
        }
        const scheduleForm = document.getElementById('schedule-form');
        if (scheduleForm) {
          scheduleForm.addEventListener('submit', handleScheduleSubmit);
        }
        const modalDelete = document.getElementById('modal-delete');
        if (modalDelete) {
          modalDelete.addEventListener('click', handleScheduleDelete);
        }
        
        // Populate client select
        populateClientSelect();
        
        // Swipe detection for circular component navigation
        const monthCircular = document.getElementById('month-circular-component');
        const dayCircular = document.getElementById('day-circular-component');
        
        [monthCircular, dayCircular].forEach(component => {
          if (component) {
            component.addEventListener('touchstart', (e) => {
              touchStartX = e.changedTouches[0].screenX;
              isSwipeEnabled = true;
            }, { passive: true });
            
            component.addEventListener('touchend', (e) => {
              if (isSwipeEnabled) {
                touchEndX = e.changedTouches[0].screenX;
                handleCircularSwipe();
              }
            }, { passive: true });
          }
        });
        
        // Day navigation
        const prevDay = document.getElementById('prev-day');
        const nextDay = document.getElementById('next-day');
        const todayDay = document.getElementById('today-day');
        if (prevDay) {
          prevDay.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() - 1);
            renderDayView();
          });
        }
        if (nextDay) {
          nextDay.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() + 1);
            renderDayView();
          });
        }
        if (todayDay) {
          todayDay.addEventListener('click', () => {
            currentDate = new Date();
            renderDayView();
          });
        }
        
        // Day period toggle
        const periodMorning = document.getElementById('period-morning');
        const periodAfternoon = document.getElementById('period-afternoon');
        if (periodMorning) {
          periodMorning.addEventListener('click', () => {
            selectedTimePeriod = 'morning';
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
            periodMorning.classList.add('active');
            document.getElementById('day-icon-sun').classList.add('active');
            document.getElementById('day-icon-moon').classList.remove('active');
            renderDayView();
          });
        }
        if (periodAfternoon) {
          periodAfternoon.addEventListener('click', () => {
            selectedTimePeriod = 'afternoon';
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
            periodAfternoon.classList.add('active');
            document.getElementById('day-icon-sun').classList.remove('active');
            document.getElementById('day-icon-moon').classList.add('active');
            renderDayView();
          });
        }
        
        // Initial render
        renderMonthView();
      }
      
      function handleCircularSwipe() {
        const swipeThreshold = 50;
        const diff = touchStartX - touchEndX;
        
        if (Math.abs(diff) > swipeThreshold) {
          if (currentView === 'month') {
            if (diff > 0) {
              currentDate.setMonth(currentDate.getMonth() + 1);
            } else {
              currentDate.setMonth(currentDate.getMonth() - 1);
            }
            renderMonthView();
          } else if (currentView === 'week') {
            if (diff > 0) {
              currentDate.setDate(currentDate.getDate() + 7);
            } else {
              currentDate.setDate(currentDate.getDate() - 7);
            }
            renderWeekView();
          } else if (currentView === 'day') {
            if (diff > 0) {
              currentDate.setDate(currentDate.getDate() + 1);
            } else {
              currentDate.setDate(currentDate.getDate() - 1);
            }
            renderDayView();
          }
        }
      }
      
      function switchView(view) {
        currentView = view;
        document.querySelectorAll('.view-tab').forEach(tab => {
          tab.classList.toggle('active', tab.dataset.view === view);
        });
        document.querySelectorAll('.view-container').forEach(container => {
          container.classList.add('hidden');
        });
        
        // Reset selections when switching views
        selectedDate = null;
        selectedDayOfWeek = null;
        selectedDayOfMonth = null;
        selectedTimeSlot = null;
        
        if (view === 'month') {
          document.getElementById('month-view').classList.remove('hidden');
          renderMonthView();
        } else if (view === 'week') {
          document.getElementById('week-view').classList.remove('hidden');
          renderWeekView();
        } else if (view === 'day') {
          document.getElementById('day-view').classList.remove('hidden');
          renderDayView();
        }
      }
      
      function renderMonthView() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
        
        document.getElementById('current-month').textContent = `${year}年${monthNames[month]}`;
        
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        
        // Render circular component for month view
        renderMonthCircularComponent(year, month, daysInMonth);
        
        // Update center label and schedule list based on current rotation
        const svg = document.querySelector('#month-circular-component .circular-svg');
        if (svg) {
          // Determine which day should be at the reference point
          const today = new Date();
          if (year === today.getFullYear() && month === today.getMonth() && selectedDayOfMonth === today.getDate()) {
            // If viewing current month and today is selected, rotate to today's center
            const segmentAngle = 360 / daysInMonth;
            rotationAngle = -(selectedDayOfMonth - 0.5) * segmentAngle;
            applyRotation(svg, rotationAngle);
          } else if (!selectedDayOfMonth || selectedDayOfMonth < 1 || selectedDayOfMonth > daysInMonth) {
            // If no valid selection, set to first day
            selectedDayOfMonth = 1;
            const segmentAngle = 360 / daysInMonth;
            rotationAngle = -(1 - 0.5) * segmentAngle; // First day (day 1) center at 0°
            applyRotation(svg, rotationAngle);
          }
          // Update center label and schedule list
          updateCenterLabelAndSchedule(svg, daysInMonth, year, month);
        }
      }
      
      function renderMonthCircularComponent(year, month, daysInMonth) {
        const svg = document.querySelector('#month-circular-component .circular-svg');
        if (!svg) return;
        
        // Reset rotation when view changes - set to first day's center at 0°
        const segmentAngle = 360 / daysInMonth;
        rotationAngle = -(1 - 0.5) * segmentAngle; // First day (day 1) center at 0°
        // Normalize angle
        while (rotationAngle < -360) rotationAngle += 360;
        while (rotationAngle > 360) rotationAngle -= 360;
        applyRotation(svg, rotationAngle);
        
        svg.innerHTML = '';
        const centerX = 100;
        const centerY = 100;
        const radius = 80; // Slightly smaller overall
        const indicatorRadius = radius; // Outer circle for day indicators
        // Inner circle for schedule indicators: 4px gap between circles
        // Outer circle inner edge: indicatorRadius - stroke-width/2 = radius - 8
        // Inner circle outer edge: scheduleRadius + stroke-width/2
        // Gap = (radius - 8) - (scheduleRadius + 6) = 4
        // Therefore: scheduleRadius = radius - 18
        const scheduleRadius = radius - 18; // Inner circle for schedule indicators (4px gap)
        const anglePerDay = 360 / daysInMonth;
        
        // Add rotation handlers
        setupRotationHandlers(svg, centerX, centerY, daysInMonth);
        
        // Get schedules for this month
        const monthSchedules = schedules.filter(s => {
          const scheduleDate = new Date(s.date);
          return scheduleDate.getFullYear() === year && 
                 scheduleDate.getMonth() === month && 
                 s.status !== 'completed';
        });
        
        // Group schedules by day
        const schedulesByDay = {};
        monthSchedules.forEach(s => {
          const day = parseInt(s.date.split('-')[2]);
          if (!schedulesByDay[day]) {
            schedulesByDay[day] = [];
          }
          schedulesByDay[day].push(s);
        });
        
        // Calculate the day of week for the first day of the month
        const firstDayOfMonth = new Date(year, month, 1);
        const firstDayOfWeek = firstDayOfMonth.getDay(); // 0 = Sunday, 6 = Saturday
        
        // Draw outer indicator circle segments (day indicators) - all white
        for (let day = 1; day <= daysInMonth; day++) {
          const startAngle = (day - 1) * anglePerDay;
          const endAngle = day * anglePerDay;
          
          // Convert angles to radians
          const startRad = (startAngle * Math.PI) / 180;
          const endRad = (endAngle * Math.PI) / 180;
          
          // Calculate arc path for outer indicator circle
          const x1 = centerX + indicatorRadius * Math.cos(startRad);
          const y1 = centerY + indicatorRadius * Math.sin(startRad);
          const x2 = centerX + indicatorRadius * Math.cos(endRad);
          const y2 = centerY + indicatorRadius * Math.sin(endRad);
          const largeArcFlag = anglePerDay > 180 ? 1 : 0;
          
          const indicatorPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          indicatorPath.setAttribute('d', `M ${x1} ${y1} A ${indicatorRadius} ${indicatorRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
          indicatorPath.setAttribute('class', 'day-indicator-segment');
          svg.appendChild(indicatorPath);
        }
        
        // Draw border lines for Saturday and Sunday on the outer edge
        for (let day = 1; day <= daysInMonth; day++) {
          const dayOfWeek = (firstDayOfWeek + day - 1) % 7;
          
          // Only draw border for Saturday (6) or Sunday (0)
          if (dayOfWeek === 6 || dayOfWeek === 0) {
            const startAngle = (day - 1) * anglePerDay;
            const endAngle = day * anglePerDay;
            
            // Convert angles to radians
            const startRad = (startAngle * Math.PI) / 180;
            const endRad = (endAngle * Math.PI) / 180;
            
            // Calculate arc path for border line (outside the main circle)
            const borderRadius = indicatorRadius + 8; // Outside the main circle
            const x1 = centerX + borderRadius * Math.cos(startRad);
            const y1 = centerY + borderRadius * Math.sin(startRad);
            const x2 = centerX + borderRadius * Math.cos(endRad);
            const y2 = centerY + borderRadius * Math.sin(endRad);
            const largeArcFlag = anglePerDay > 180 ? 1 : 0;
            
            const borderPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            borderPath.setAttribute('d', `M ${x1} ${y1} A ${borderRadius} ${borderRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
            borderPath.setAttribute('class', `day-border-line ${dayOfWeek === 6 ? 'saturday' : 'sunday'}`);
            svg.appendChild(borderPath);
          }
        }
        
        // Draw inner schedule circle segments (only for days with schedules)
        for (let day = 1; day <= daysInMonth; day++) {
          const hasSchedule = schedulesByDay[day] && schedulesByDay[day].length > 0;
          
          if (hasSchedule) {
            const startAngle = (day - 1) * anglePerDay;
            const endAngle = day * anglePerDay;
            
            // Convert angles to radians
            const startRad = (startAngle * Math.PI) / 180;
            const endRad = (endAngle * Math.PI) / 180;
            
            // Calculate arc path for inner schedule circle
            const x1 = centerX + scheduleRadius * Math.cos(startRad);
            const y1 = centerY + scheduleRadius * Math.sin(startRad);
            const x2 = centerX + scheduleRadius * Math.cos(endRad);
            const y2 = centerY + scheduleRadius * Math.sin(endRad);
            const largeArcFlag = anglePerDay > 180 ? 1 : 0;
            
            const schedulePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            schedulePath.setAttribute('d', `M ${x1} ${y1} A ${scheduleRadius} ${scheduleRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
            schedulePath.setAttribute('class', 'schedule-indicator-segment');
            svg.appendChild(schedulePath);
          }
        }
        
        // Draw clickable transparent segments for interaction
        for (let day = 1; day <= daysInMonth; day++) {
          const startAngle = (day - 1) * anglePerDay;
          const endAngle = day * anglePerDay;
          const isSelected = selectedDayOfMonth === day;
          
          // Convert angles to radians
          const startRad = (startAngle * Math.PI) / 180;
          const endRad = (endAngle * Math.PI) / 180;
          
          // Calculate arc path (using indicator radius for clickable area)
          const x1 = centerX + indicatorRadius * Math.cos(startRad);
          const y1 = centerY + indicatorRadius * Math.sin(startRad);
          const x2 = centerX + indicatorRadius * Math.cos(endRad);
          const y2 = centerY + indicatorRadius * Math.sin(endRad);
          const largeArcFlag = anglePerDay > 180 ? 1 : 0;
          
          const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          path.setAttribute('d', `M ${x1} ${y1} A ${indicatorRadius} ${indicatorRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
          path.setAttribute('class', `circular-segment ${isSelected ? 'selected' : ''}`);
          path.setAttribute('data-day', day);
          path.addEventListener('click', () => {
            // Rotate to bring this segment's center to reference point (0°)
            const segmentAngle = 360 / daysInMonth;
            // Segment center angle: (day - 0.5) * segmentAngle
            // To bring center to 0°, rotate by: -(day - 0.5) * segmentAngle
            const targetAngle = -(day - 0.5) * segmentAngle;
            rotationAngle = targetAngle;
            animateRotation(svg, targetAngle, () => {
              selectedDayOfMonth = day;
              updateCenterLabelAndSchedule(svg, daysInMonth, year, month);
            });
          });
          svg.appendChild(path);
        }
        
        // Add labels on the indicator circle line
        for (let day = 1; day <= daysInMonth; day++) {
          const startAngle = (day - 1) * anglePerDay;
          const endAngle = day * anglePerDay;
          const hasSchedule = schedulesByDay[day] && schedulesByDay[day].length > 0;
          
          const labelAngle = (startAngle + endAngle) / 2;
          const labelRad = (labelAngle * Math.PI) / 180;
          // Position label on the indicator circle line
          const labelRadius = indicatorRadius;
          const labelX = centerX + labelRadius * Math.cos(labelRad);
          const labelY = centerY + labelRadius * Math.sin(labelRad);
          
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', labelX);
          text.setAttribute('y', labelY);
          text.setAttribute('class', `circular-segment-label ${hasSchedule ? 'has-schedule' : ''}`);
          text.setAttribute('text-anchor', 'middle');
          text.setAttribute('dominant-baseline', 'middle');
          // Rotate text to be upright (add 90 degrees to compensate for SVG rotation)
          text.setAttribute('transform', `rotate(${labelAngle + 90} ${labelX} ${labelY})`);
          text.textContent = day;
          svg.appendChild(text);
        }
      }
      
      function createCalendarDay(dayNumber, isOtherMonth, dateStr = null) {
        const day = document.createElement('div');
        day.className = 'calendar-day';
        if (isOtherMonth) {
          day.classList.add('other-month');
        }
        const dayNumberDiv = document.createElement('div');
        dayNumberDiv.className = 'calendar-day-number';
        dayNumberDiv.textContent = dayNumber;
        day.appendChild(dayNumberDiv);
        
        // Calculate date string if not provided
        if (!dateStr) {
          const year = currentDate.getFullYear();
          const month = currentDate.getMonth();
          dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(dayNumber).padStart(2, '0')}`;
        }
        day.dataset.date = dateStr;
        
        // Check if day has events (including other month days)
        const daySchedules = schedules.filter(s => s.date === dateStr && s.status !== 'completed');
        if (daySchedules.length > 0) {
          day.classList.add('has-event');
          const eventsDiv = document.createElement('div');
          eventsDiv.className = 'calendar-day-events';
          
          // Show event count badge if more than 3 events
          if (daySchedules.length > 3) {
            const countBadge = document.createElement('div');
            countBadge.className = 'calendar-event-count';
            countBadge.textContent = daySchedules.length;
            eventsDiv.appendChild(countBadge);
          } else {
            // Show dots for up to 3 events
            daySchedules.slice(0, 3).forEach(() => {
              const dot = document.createElement('div');
              dot.className = 'calendar-event-dot';
              eventsDiv.appendChild(dot);
            });
          }
          day.appendChild(eventsDiv);
        }
        
        // Mark as selected if this date is selected
        if (selectedDate === dateStr) {
          day.classList.add('selected');
        }
        
        day.addEventListener('click', (e) => {
          e.stopPropagation();
          // Remove selected class from all days
          document.querySelectorAll('.calendar-day').forEach(d => {
            d.classList.remove('selected');
          });
          
          // Add selected class to clicked day
          day.classList.add('selected');
          
          // Show schedules for this date
          if (daySchedules.length > 0) {
            showSelectedDateSchedules(dateStr);
          } else {
            // If no schedules, open modal to add new schedule
          openScheduleModal(dateStr);
          }
        });
        
        return day;
      }
      
      function renderWeekView() {
        const startOfWeek = getStartOfWeek(currentDate);
        const endOfWeek = new Date(startOfWeek);
        endOfWeek.setDate(endOfWeek.getDate() + 6);
        
        document.getElementById('week-range').textContent = `${formatDateDisplay(startOfWeek)} - ${formatDateDisplay(endOfWeek)}`;
        
        // Render schedule list for selected day
        if (selectedDayOfWeek !== null) {
          const selectedDate = new Date(startOfWeek);
          selectedDate.setDate(startOfWeek.getDate() + selectedDayOfWeek);
          const dateStr = formatDate(selectedDate);
          renderScheduleListForDate(dateStr, 'week-schedule-list');
        } else {
          // Default to today if it's in this week
          const today = new Date();
          const todayDayOfWeek = today.getDay();
          if (today >= startOfWeek && today <= endOfWeek) {
            selectedDayOfWeek = todayDayOfWeek;
            const dateStr = formatDate(today);
            renderScheduleListForDate(dateStr, 'week-schedule-list');
          } else {
            document.getElementById('week-schedule-list').innerHTML = '<p style="text-align: center; color: #6b7280; padding: 20px;">曜日を選択してください</p>';
          }
        }
      }
      
      
      function renderDayView() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        const day = currentDate.getDate();
        const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
        
        document.getElementById('current-day').textContent = `${year}年${monthNames[month]}${day}日`;
        
        // Render circular component for day view
        renderDayCircularComponent();
        
        // Initialize center display for day view
        const dateStr = formatDate(currentDate);
        if (selectedTimeSlot !== null) {
          const [start, end] = selectedTimeSlot.split('-').map(Number);
          const slot = { start, end, label: `${start}` };
          updateDayCenterDisplay(slot, dateStr);
          renderScheduleListForTimeSlot(dateStr, selectedTimeSlot, 'day-schedule-list');
        } else {
          // Default to first time slot of selected period
          const defaultSlot = selectedTimePeriod === 'morning' 
            ? { start: 0, end: 1, label: '0' }
            : { start: 12, end: 13, label: '12' };
          selectedTimeSlot = `${defaultSlot.start}-${defaultSlot.end}`;
          updateDayCenterDisplay(defaultSlot, dateStr);
          renderScheduleListForTimePeriod(dateStr, selectedTimePeriod, 'day-schedule-list');
        }
      }
      
      function renderDayCircularComponent() {
        const svg = document.querySelector('#day-circular-component .circular-svg');
        if (!svg) return;
        
        // Reset rotation when view changes
        rotationAngle = 0;
        // Normalize angle
        while (rotationAngle < -360) rotationAngle += 360;
        while (rotationAngle > 360) rotationAngle -= 360;
        applyRotation(svg, rotationAngle);
        
        svg.innerHTML = '';
        const centerX = 100;
        const centerY = 100;
        const radius = 80; // Slightly smaller overall
        const indicatorRadius = radius; // Outer circle for time indicators
        const scheduleRadius = radius - 8; // Inner circle for schedule indicators (8px smaller)
        
        // Add rotation handlers (12 segments for day view)
        setupRotationHandlers(svg, centerX, centerY, 12);
        
        // Define time slots for morning (0-12) and afternoon (12-24)
        // Each period has 12 one-hour slots
        const timeSlots = [];
        if (selectedTimePeriod === 'morning') {
          // Morning: 0-12 (12 hours)
          for (let hour = 0; hour < 12; hour++) {
            timeSlots.push({
              start: hour,
              end: hour + 1,
              label: `${hour}`
            });
          }
        } else {
          // Afternoon: 12-24 (12 hours)
          for (let hour = 12; hour < 24; hour++) {
            timeSlots.push({
              start: hour,
              end: hour + 1,
              label: `${hour}`
            });
          }
        }
        
        const anglePerSlot = 360 / timeSlots.length;
        const dateStr = formatDate(currentDate);
        
        // Get schedules for this day
        const daySchedules = schedules.filter(s => {
          if (s.date !== dateStr || s.status === 'completed') return false;
          const timeHour = parseInt(s.time.split(':')[0]);
          return selectedTimePeriod === 'morning' ? timeHour < 12 : timeHour >= 12;
        });
        
        // Group schedules by time slot (hour)
        const schedulesBySlot = {};
        daySchedules.forEach(s => {
          const timeHour = parseInt(s.time.split(':')[0]);
          const key = `${timeHour}-${timeHour + 1}`;
          if (!schedulesBySlot[key]) {
            schedulesBySlot[key] = [];
          }
          schedulesBySlot[key].push(s);
        });
        
        // Draw outer indicator circle segments (time indicators - all white)
        timeSlots.forEach((slot, index) => {
          const startAngle = index * anglePerSlot;
          const endAngle = (index + 1) * anglePerSlot;
          
          // Convert angles to radians
          const startRad = (startAngle * Math.PI) / 180;
          const endRad = (endAngle * Math.PI) / 180;
          
          // Calculate arc path for outer indicator circle
          const x1 = centerX + indicatorRadius * Math.cos(startRad);
          const y1 = centerY + indicatorRadius * Math.sin(startRad);
          const x2 = centerX + indicatorRadius * Math.cos(endRad);
          const y2 = centerY + indicatorRadius * Math.sin(endRad);
          const largeArcFlag = anglePerSlot > 180 ? 1 : 0;
          
          const indicatorPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          indicatorPath.setAttribute('d', `M ${x1} ${y1} A ${indicatorRadius} ${indicatorRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
          indicatorPath.setAttribute('class', 'day-indicator-segment weekday');
          svg.appendChild(indicatorPath);
        });
        
        // Draw inner schedule circle segments (only for time slots with schedules)
        timeSlots.forEach((slot, index) => {
          const key = `${slot.start}-${slot.end}`;
          const hasSchedule = schedulesBySlot[key] && schedulesBySlot[key].length > 0;
          
          if (hasSchedule) {
            const startAngle = index * anglePerSlot;
            const endAngle = (index + 1) * anglePerSlot;
            
            // Convert angles to radians
            const startRad = (startAngle * Math.PI) / 180;
            const endRad = (endAngle * Math.PI) / 180;
            
            // Calculate arc path for inner schedule circle
            const x1 = centerX + scheduleRadius * Math.cos(startRad);
            const y1 = centerY + scheduleRadius * Math.sin(startRad);
            const x2 = centerX + scheduleRadius * Math.cos(endRad);
            const y2 = centerY + scheduleRadius * Math.sin(endRad);
            const largeArcFlag = anglePerSlot > 180 ? 1 : 0;
            
            const schedulePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            schedulePath.setAttribute('d', `M ${x1} ${y1} A ${scheduleRadius} ${scheduleRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
            schedulePath.setAttribute('class', 'schedule-indicator-segment');
            svg.appendChild(schedulePath);
          }
        });
        
        // Draw clickable transparent segments for interaction
        timeSlots.forEach((slot, index) => {
          const startAngle = index * anglePerSlot;
          const endAngle = (index + 1) * anglePerSlot;
          const key = `${slot.start}-${slot.end}`;
          const isSelected = selectedTimeSlot === key;
          
          // Convert angles to radians
          const startRad = (startAngle * Math.PI) / 180;
          const endRad = (endAngle * Math.PI) / 180;
          
          // Calculate arc path (using indicator radius for clickable area)
          const x1 = centerX + indicatorRadius * Math.cos(startRad);
          const y1 = centerY + indicatorRadius * Math.sin(startRad);
          const x2 = centerX + indicatorRadius * Math.cos(endRad);
          const y2 = centerY + indicatorRadius * Math.sin(endRad);
          const largeArcFlag = anglePerSlot > 180 ? 1 : 0;
          
          const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          path.setAttribute('d', `M ${x1} ${y1} A ${indicatorRadius} ${indicatorRadius} 0 ${largeArcFlag} 1 ${x2} ${y2}`);
          path.setAttribute('class', `circular-segment ${isSelected ? 'selected' : ''}`);
          path.setAttribute('data-slot', key);
          path.addEventListener('click', () => {
            // Rotate to bring this segment's center to reference point (0°)
            const segmentAngle = 360 / timeSlots.length;
            // Segment center angle: (index + 0.5) * segmentAngle
            // To bring center to 0°, rotate by: -(index + 0.5) * segmentAngle
            const targetAngle = -(index + 0.5) * segmentAngle;
            rotationAngle = targetAngle;
            animateRotation(svg, targetAngle, () => {
              selectedTimeSlot = key;
              const dateStr = formatDate(currentDate);
              updateDayCenterDisplay(slot, dateStr);
              renderScheduleListForTimeSlot(dateStr, key, 'day-schedule-list');
            });
          });
          svg.appendChild(path);
        });
        
        // Add labels on the indicator circle line
        timeSlots.forEach((slot, index) => {
          const startAngle = index * anglePerSlot;
          const endAngle = (index + 1) * anglePerSlot;
          const key = `${slot.start}-${slot.end}`;
          const hasSchedule = schedulesBySlot[key] && schedulesBySlot[key].length > 0;
          
          const labelAngle = (startAngle + endAngle) / 2;
          const labelRad = (labelAngle * Math.PI) / 180;
          // Position label on the indicator circle line
          const labelRadius = indicatorRadius;
          const labelX = centerX + labelRadius * Math.cos(labelRad);
          const labelY = centerY + labelRadius * Math.sin(labelRad);
          
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', labelX);
          text.setAttribute('y', labelY);
          text.setAttribute('class', `circular-segment-label ${hasSchedule ? 'has-schedule' : ''}`);
          text.setAttribute('text-anchor', 'middle');
          text.setAttribute('dominant-baseline', 'middle');
          // Rotate text to be upright (add 90 degrees to compensate for SVG rotation)
          text.setAttribute('transform', `rotate(${labelAngle + 90} ${labelX} ${labelY})`);
          text.textContent = slot.label;
          svg.appendChild(text);
        });
      }
      
      function renderScheduleListForDate(dateStr, listId) {
        const daySchedules = schedules.filter(s => s.date === dateStr && s.status !== 'completed');
        const listContainer = document.getElementById(listId);
        if (!listContainer) return;
        
        if (daySchedules.length === 0) {
          listContainer.innerHTML = '<p style="text-align: center; color: #6b7280; padding: 20px;">この日のスケジュールはありません</p>';
          return;
        }
        
        listContainer.innerHTML = '';
        daySchedules.sort((a, b) => a.time.localeCompare(b.time)).forEach(schedule => {
          const item = createScheduleItem(schedule);
          item.style.cursor = 'pointer';
          item.addEventListener('click', () => {
            // Navigate to detail page or open modal
            window.location.href = `/sales/schedules/${schedule.id}.html`;
          });
          listContainer.appendChild(item);
        });
      }
      
      function renderScheduleListForTimePeriod(dateStr, period, listId) {
        const daySchedules = schedules.filter(s => {
          if (s.date !== dateStr || s.status === 'completed') return false;
          const timeHour = parseInt(s.time.split(':')[0]);
          return period === 'morning' ? timeHour < 12 : timeHour >= 12;
        });
        
        const listContainer = document.getElementById(listId);
        if (!listContainer) return;
        
        if (daySchedules.length === 0) {
          listContainer.innerHTML = `<p style="text-align: center; color: #6b7280; padding: 20px;">${period === 'morning' ? '午前' : '午後'}のスケジュールはありません</p>`;
          return;
        }
        
        listContainer.innerHTML = '';
        daySchedules.sort((a, b) => a.time.localeCompare(b.time)).forEach(schedule => {
          const item = createScheduleItem(schedule);
          item.style.cursor = 'pointer';
          item.addEventListener('click', () => {
            window.location.href = `/sales/schedules/${schedule.id}.html`;
          });
          listContainer.appendChild(item);
        });
      }
      
      function renderScheduleListForTimeSlot(dateStr, timeSlot, listId) {
        const [start, end] = timeSlot.split('-').map(Number);
        const daySchedules = schedules.filter(s => {
          if (s.date !== dateStr || s.status === 'completed') return false;
          const timeHour = parseInt(s.time.split(':')[0]);
          return timeHour >= start && timeHour < end;
        });
        
        const listContainer = document.getElementById(listId);
        if (!listContainer) return;
        
        if (daySchedules.length === 0) {
          listContainer.innerHTML = `<p style="text-align: center; color: #6b7280; padding: 20px;">${start}:00-${end}:00のスケジュールはありません</p>`;
          return;
        }
        
        listContainer.innerHTML = '';
        daySchedules.sort((a, b) => a.time.localeCompare(b.time)).forEach(schedule => {
          const item = createScheduleItem(schedule);
          item.style.cursor = 'pointer';
          item.addEventListener('click', () => {
            window.location.href = `/sales/schedules/${schedule.id}.html`;
          });
          listContainer.appendChild(item);
        });
      }
      
      
      function createScheduleItem(schedule, isHistory = false) {
        const item = document.createElement('div');
        item.className = 'schedule-item';
        if (schedule.status === 'completed' || isHistory) {
          item.classList.add('completed');
        }
        
        const scheduleDate = new Date(schedule.date);
        const dayOfWeek = ['日', '月', '火', '水', '木', '金', '土'][scheduleDate.getDay()];
        
        item.innerHTML = `
          <div class="item-date">
            <span class="date-day">${scheduleDate.getDate()}</span>
            <span class="date-dow">${dayOfWeek}</span>
          </div>
          <div class="item-content">
            <div class="item-time">${schedule.time}</div>
            <div class="item-client">${schedule.client_name}</div>
            <div class="item-store">${schedule.store_name || ''}</div>
            <span class="item-purpose">${schedule.purpose}</span>
            ${schedule.address ? `<div class="item-address"><i class="fas fa-map-marker-alt"></i> ${schedule.address}</div>` : ''}
            <div class="item-actions">
              ${schedule.address ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(schedule.address)}" target="_blank" class="action-btn map-btn"><i class="fas fa-map"></i> 地図</a>` : ''}
              ${schedule.address ? `<a href="https://maps.apple.com/?q=${encodeURIComponent(schedule.address)}" target="_blank" class="action-btn map-btn"><i class="fas fa-location-arrow"></i> ナビ</a>` : ''}
              ${schedule.phone ? `<a href="tel:${schedule.phone}" class="action-btn"><i class="fas fa-phone"></i> 電話</a>` : ''}
              ${schedule.email ? `<a href="mailto:${schedule.email}" class="action-btn"><i class="fas fa-envelope"></i> メール</a>` : ''}
              ${!isHistory ? `<button class="action-btn edit-btn" data-id="${schedule.id}"><i class="fas fa-edit"></i> 編集</button>` : ''}
              ${!isHistory ? `<button class="action-btn complete-btn" data-id="${schedule.id}"><i class="fas fa-check"></i> 完了</button>` : ''}
              ${!isHistory ? `<button class="action-btn delete-btn" data-id="${schedule.id}"><i class="fas fa-trash"></i> 削除</button>` : ''}
            </div>
          </div>
        `;
        
        // Add event listeners
        item.querySelectorAll('.edit-btn').forEach(btn => {
          btn.addEventListener('click', () => openScheduleModal(null, btn.dataset.id));
        });
        item.querySelectorAll('.complete-btn').forEach(btn => {
          btn.addEventListener('click', () => completeSchedule(btn.dataset.id));
        });
        item.querySelectorAll('.delete-btn').forEach(btn => {
          btn.addEventListener('click', () => deleteSchedule(btn.dataset.id));
        });
        
        return item;
      }
      
      function openScheduleModal(dateStr = null, scheduleId = null) {
        const modal = document.getElementById('schedule-modal');
        const form = document.getElementById('schedule-form');
        const modalTitle = document.getElementById('modal-title');
        const deleteBtn = document.getElementById('modal-delete');
        
        form.reset();
        document.getElementById('schedule-id').value = '';
        
        if (scheduleId) {
          // Edit mode
          const schedule = schedules.find(s => s.id === scheduleId);
          if (schedule) {
            modalTitle.textContent = 'スケジュール編集';
            deleteBtn.classList.remove('hidden');
            document.getElementById('schedule-id').value = schedule.id;
            document.getElementById('schedule-date').value = schedule.date;
            document.getElementById('schedule-time').value = schedule.time;
            document.getElementById('schedule-client').value = schedule.client_id;
            updateStoreSelect(schedule.client_id);
            document.getElementById('schedule-store').value = schedule.store_name || '';
            document.getElementById('schedule-purpose').value = schedule.purpose;
            document.getElementById('schedule-address').value = schedule.address || '';
            document.getElementById('schedule-phone').value = schedule.phone || '';
            document.getElementById('schedule-email').value = schedule.email || '';
            document.getElementById('schedule-notes').value = schedule.notes || '';
          }
        } else {
          // Add mode
          modalTitle.textContent = 'スケジュール追加';
          deleteBtn.classList.add('hidden');
          if (dateStr) {
            document.getElementById('schedule-date').value = dateStr;
          }
        }
        
        modal.classList.add('active');
      }
      
      function closeScheduleModal() {
        document.getElementById('schedule-modal').classList.remove('active');
      }
      
      function handleScheduleSubmit(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const scheduleId = formData.get('id');
        
        const schedule = {
          id: scheduleId || `schedule-${Date.now()}`,
          date: formData.get('date'),
          time: formData.get('time'),
          client_id: formData.get('client_id'),
          client_name: getClientName(formData.get('client_id')),
          store_name: formData.get('store_name'),
          purpose: formData.get('purpose'),
          address: formData.get('address'),
          phone: formData.get('phone'),
          email: formData.get('email'),
          notes: formData.get('notes'),
          status: scheduleId ? schedules.find(s => s.id === scheduleId)?.status || 'upcoming' : 'upcoming'
        };
        
        if (scheduleId) {
          // Update
          const index = schedules.findIndex(s => s.id === scheduleId);
          if (index !== -1) {
            schedules[index] = schedule;
          }
        } else {
          // Add
          schedules.push(schedule);
        }
        
        closeScheduleModal();
        refreshCurrentView();
        
        // In real app, save to API
        alert('スケジュールを保存しました');
      }
      
      function handleScheduleDelete() {
        const scheduleId = document.getElementById('schedule-id').value;
        if (!scheduleId) return;
        
        if (confirm('このスケジュールを削除しますか？')) {
          deleteSchedule(scheduleId);
          closeScheduleModal();
        }
      }
      
      function deleteSchedule(scheduleId) {
        schedules = schedules.filter(s => s.id !== scheduleId);
        refreshCurrentView();
        alert('スケジュールを削除しました');
      }
      
      function completeSchedule(scheduleId) {
        const schedule = schedules.find(s => s.id === scheduleId);
        if (schedule) {
          schedule.status = 'completed';
          history.push(schedule);
          refreshCurrentView();
          alert('スケジュールを完了しました');
        }
      }
      
      function populateClientSelect() {
        const select = document.getElementById('schedule-client');
        select.innerHTML = '<option value="">選択してください</option>';
        
        if (clientsData.clients) {
          clientsData.clients.forEach(client => {
            const option = document.createElement('option');
            option.value = client.id;
            option.textContent = client.company_name;
            select.appendChild(option);
          });
        }
        
        // Update store when client changes
        select.addEventListener('change', (e) => {
          updateStoreSelect(e.target.value);
        });
      }
      
      function updateStoreSelect(clientId) {
        const storeInput = document.getElementById('schedule-store');
        // In real app, fetch stores for this client
        // For now, just enable the input
        storeInput.disabled = !clientId;
      }
      
      function getClientName(clientId) {
        if (!clientsData.clients) return '';
        const client = clientsData.clients.find(c => c.id === clientId);
        return client ? client.company_name : '';
      }
      
      function refreshCurrentView() {
        if (currentView === 'month') {
          renderMonthView();
        } else if (currentView === 'week') {
          renderWeekView();
        } else if (currentView === 'day') {
          renderDayView();
        } else if (currentView === 'history') {
          renderHistoryView();
        }
      }
      
      function getStartOfWeek(date) {
        const d = new Date(date);
        const day = d.getDay();
        const diff = d.getDate() - day;
        return new Date(d.setDate(diff));
      }
      
      function formatDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      }
      
      function formatDateDisplay(date) {
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();
        return `${year}年${month}月${day}日`;
      }
      
      // Rotation functions
      function setupRotationHandlers(svg, centerX, centerY, segmentCount) {
        // Prevent duplicate handler registration
        if (rotationHandlersSetup.has(svg)) {
          return;
        }
        rotationHandlersSetup.add(svg);
        
        // Mouse events
        svg.addEventListener('mousedown', (e) => {
          e.preventDefault();
          handleDragStart(e, svg, centerX, centerY, segmentCount);
        });
        
        // Touch events
        svg.addEventListener('touchstart', (e) => {
          e.preventDefault();
          handleDragStart(e, svg, centerX, centerY, segmentCount);
        }, { passive: false });
      }
      
      // Global mouse/touch move and end handlers (only one set needed)
      if (!window.rotationGlobalHandlersSetup) {
        window.rotationGlobalHandlersSetup = true;
        
        document.addEventListener('mousemove', (e) => {
          if (isDragging && currentSvg) {
            e.preventDefault();
            const segmentCount = currentView === 'month' 
              ? new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate()
              : 12;
            handleDrag(e, currentSvg, 100, 100, segmentCount);
          }
        });
        
        document.addEventListener('mouseup', (e) => {
          if (isDragging && currentSvg) {
            e.preventDefault();
            const segmentCount = currentView === 'month' 
              ? new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate()
              : 12;
            handleDragEnd(currentSvg, segmentCount);
          }
        });
        
        document.addEventListener('touchmove', (e) => {
          if (isDragging && currentSvg) {
            e.preventDefault();
            const segmentCount = currentView === 'month' 
              ? new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate()
              : 12;
            handleDrag(e, currentSvg, 100, 100, segmentCount);
          }
        }, { passive: false });
        
        document.addEventListener('touchend', (e) => {
          if (isDragging && currentSvg) {
            e.preventDefault();
            const segmentCount = currentView === 'month' 
              ? new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate()
              : 12;
            handleDragEnd(currentSvg, segmentCount);
          }
        });
      }
      
      function getEventPoint(e) {
        if (e.touches && e.touches.length > 0) {
          const rect = currentSvg.getBoundingClientRect();
          return {
            x: e.touches[0].clientX - rect.left,
            y: e.touches[0].clientY - rect.top
          };
        } else {
          const rect = currentSvg.getBoundingClientRect();
          return {
            x: e.clientX - rect.left,
            y: e.clientY - rect.top
          };
        }
      }
      
      function getAngleFromCenter(point, centerX, centerY) {
        // SVG viewBox is 200x200, so we need to scale
        const svgRect = currentSvg.getBoundingClientRect();
        const scaleX = 200 / svgRect.width;
        const scaleY = 200 / svgRect.height;
        
        const scaledX = point.x * scaleX;
        const scaledY = point.y * scaleY;
        
        const dx = scaledX - centerX;
        const dy = scaledY - centerY;
        // Convert to degrees and adjust for SVG's -90deg base rotation
        return Math.atan2(dy, dx) * 180 / Math.PI + 90;
      }
      
      function handleDragStart(e, svg, centerX, centerY, segmentCount) {
        // Only start drag if clicking on the SVG itself, not on child elements
        if (e.target !== svg && !svg.contains(e.target)) {
          return;
        }
        
        isDragging = false; // Will be set to true after minimum drag distance
        currentSvg = svg;
        
        const point = getEventPoint(e);
        dragStartPoint = point;
        dragStartAngle = getAngleFromCenter(point, centerX, centerY);
        startRotationAngle = rotationAngle;
      }
      
      function handleDrag(e, svg, centerX, centerY, segmentCount) {
        if (!currentSvg || currentSvg !== svg) return;
        
        const point = getEventPoint(e);
        
        // Check minimum drag distance before starting rotation
        if (!isDragging) {
          const dx = point.x - dragStartPoint.x;
          const dy = point.y - dragStartPoint.y;
          const distance = Math.sqrt(dx * dx + dy * dy);
          
          if (distance < minDragDistance) {
            return; // Not enough movement yet
          }
          
          // Start dragging
          isDragging = true;
          svg.classList.add('dragging');
        }
        
        const currentAngle = getAngleFromCenter(point, centerX, centerY);
        const deltaAngle = currentAngle - dragStartAngle;
        
        // Normalize deltaAngle to -180 to 180 range to prevent large jumps
        let normalizedDelta = deltaAngle;
        while (normalizedDelta > 180) normalizedDelta -= 360;
        while (normalizedDelta < -180) normalizedDelta += 360;
        
        let newRotationAngle = startRotationAngle + normalizedDelta;
        
        // Normalize rotation angle to prevent accumulation
        while (newRotationAngle > 360) newRotationAngle -= 360;
        while (newRotationAngle < -360) newRotationAngle += 360;
        
        // Apply rotation smoothly without snapping during drag
        rotationAngle = newRotationAngle;
        applyRotation(currentSvg, rotationAngle);
      }
      
      function handleDragEnd(svg, segmentCount) {
        if (!isDragging && currentSvg !== svg) {
          // Reset if drag didn't actually start
          currentSvg = null;
          return;
        }
        
        isDragging = false;
        svg.classList.remove('dragging');
        
        // Normalize rotation angle first
        let normalizedAngle = rotationAngle % 360;
        if (normalizedAngle < 0) normalizedAngle += 360;
        
        // Final snap to nearest segment center
        const segmentAngle = 360 / segmentCount;
        // Calculate which segment's center should be at reference point (0°)
        // Segment center angles: (0.5, 1.5, 2.5, ...) * segmentAngle
        // After rotation, segment center at 0° means: rotationAngle = -(segmentIndex - 0.5) * segmentAngle
        // So: segmentIndex = -rotationAngle / segmentAngle + 0.5
        const segmentIndex = Math.round(-normalizedAngle / segmentAngle + 0.5);
        const snappedAngle = -(segmentIndex - 0.5) * segmentAngle;
        
        // Normalize snapped angle
        let normalizedSnapped = snappedAngle % 360;
        if (normalizedSnapped < 0) normalizedSnapped += 360;
        if (normalizedSnapped > 180) normalizedSnapped -= 360;
        
        // Animate to snapped position
        animateRotation(svg, normalizedSnapped, () => {
          // Update schedule list and center label after animation completes
          updateScheduleForReferencePoint(svg, segmentCount);
        });
        rotationAngle = normalizedSnapped;
        
        currentSvg = null;
        dragStartPoint = null;
      }
      
      function updateScheduleForReferencePoint(svg, segmentCount) {
        // Calculate which segment's center is at the reference point (0°)
        const segmentAngle = 360 / segmentCount;
        
        // Normalize rotation angle to 0-360 range
        let normalizedAngle = rotationAngle % 360;
        if (normalizedAngle < 0) normalizedAngle += 360;
        
        // Calculate which segment's center is at 0° (reference point)
        // Segment center angles: (0.5, 1.5, 2.5, ...) * segmentAngle
        // After rotation, segment center at 0° means: rotationAngle = -(segmentIndex - 0.5) * segmentAngle
        // So: segmentIndex = -rotationAngle / segmentAngle + 0.5
        let segmentAtReference = Math.round(-normalizedAngle / segmentAngle + 0.5) % segmentCount;
        if (segmentAtReference < 0) segmentAtReference += segmentCount;
        
        // Update schedule list and center label based on current view
        if (currentView === 'month') {
          const year = currentDate.getFullYear();
          const month = currentDate.getMonth();
          updateCenterLabelAndSchedule(svg, segmentCount, year, month);
        } else if (currentView === 'week') {
          const startOfWeek = getStartOfWeek(currentDate);
          const selectedDate = new Date(startOfWeek);
          selectedDate.setDate(startOfWeek.getDate() + segmentAtReference);
          selectedDayOfWeek = segmentAtReference;
          const dateStr = formatDate(selectedDate);
          renderScheduleListForDate(dateStr, 'week-schedule-list');
        } else if (currentView === 'day') {
          const timeSlots = selectedTimePeriod === 'morning' 
            ? Array.from({length: 12}, (_, i) => ({ start: i, end: i + 1, label: `${i}` }))
            : Array.from({length: 12}, (_, i) => ({ start: i + 12, end: i + 13, label: `${i + 12}` }));
          const slot = timeSlots[segmentAtReference];
          if (slot) {
            selectedTimeSlot = `${slot.start}-${slot.end}`;
            const dateStr = formatDate(currentDate);
            updateDayCenterDisplay(slot, dateStr);
            renderScheduleListForTimeSlot(dateStr, selectedTimeSlot, 'day-schedule-list');
          }
        }
      }
      
      function updateCenterLabelAndSchedule(svg, daysInMonth, year, month) {
        // Calculate which day's center is at the reference point (0°)
        const segmentAngle = 360 / daysInMonth;
        
        // Normalize rotation angle to 0-360 range
        let normalizedAngle = rotationAngle % 360;
        if (normalizedAngle < 0) normalizedAngle += 360;
        
        // Calculate which day's center is at 0°
        // Day center angles: (0.5, 1.5, 2.5, ...) * segmentAngle
        // After rotation, day center at 0° means: rotationAngle = -(day - 0.5) * segmentAngle
        // So: day = -rotationAngle / segmentAngle + 0.5
        let dayAtReference = Math.round(-normalizedAngle / segmentAngle + 0.5);
        if (dayAtReference < 1) dayAtReference += daysInMonth;
        if (dayAtReference > daysInMonth) dayAtReference -= daysInMonth;
        
        // Update selected day and schedule list
        selectedDayOfMonth = dayAtReference;
        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(dayAtReference).padStart(2, '0')}`;
        
        // Get date object for the selected day
        const selectedDate = new Date(year, month, dayAtReference);
        const dayOfWeekNames = ['日', '月', '火', '水', '木', '金', '土'];
        const dayOfWeek = dayOfWeekNames[selectedDate.getDay()];
        const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
        
        // Get schedule count for this day
        const daySchedules = schedules.filter(s => s.date === dateStr && s.status !== 'completed');
        const scheduleCount = daySchedules.length;
        
        // Update center display
        const dayOfWeekEl = document.getElementById('month-day-of-week');
        const dateEl = document.getElementById('month-date');
        const countEl = document.getElementById('month-schedule-count');
        
        if (dayOfWeekEl) {
          dayOfWeekEl.textContent = dayOfWeek;
        }
        if (dateEl) {
          dateEl.textContent = `${monthNames[month]}${dayAtReference}日`;
        }
        if (countEl) {
          if (scheduleCount > 0) {
            countEl.textContent = `${scheduleCount}件`;
            countEl.style.color = '#10b981';
            countEl.style.fontWeight = '600';
          } else {
            countEl.textContent = '予定なし';
            countEl.style.color = '#9ca3af';
            countEl.style.fontWeight = '500';
          }
        }
        
        renderScheduleListForDate(dateStr, 'month-schedule-list');
      }
      
      function applyRotation(svg, angle) {
        // Apply rotation while maintaining the -90deg base rotation
        svg.style.transform = `rotate(${-90 + angle}deg)`;
      }
      
      function updateDayCenterDisplay(slot, dateStr) {
        // Update period display
        const periodEl = document.getElementById('day-period');
        if (periodEl) {
          periodEl.textContent = selectedTimePeriod === 'morning' ? '午前' : '午後';
        }
        
        // Update time range display
        const timeRangeEl = document.getElementById('day-time-range');
        if (timeRangeEl) {
          const startHour = String(slot.start).padStart(2, '0');
          const endHour = String(slot.end).padStart(2, '0');
          timeRangeEl.textContent = `${startHour}:00-${endHour}:00`;
        }
        
        // Get schedule count for this time slot
        const slotSchedules = schedules.filter(s => {
          if (s.date !== dateStr || s.status === 'completed') return false;
          const timeHour = parseInt(s.time.split(':')[0]);
          return timeHour >= slot.start && timeHour < slot.end;
        });
        const scheduleCount = slotSchedules.length;
        
        // Update schedule count display
        const countEl = document.getElementById('day-schedule-count');
        if (countEl) {
          if (scheduleCount > 0) {
            countEl.textContent = `${scheduleCount}件`;
            countEl.style.color = '#10b981';
            countEl.style.fontWeight = '600';
          } else {
            countEl.textContent = '予定なし';
            countEl.style.color = '#9ca3af';
            countEl.style.fontWeight = '500';
          }
        }
      }
      
      function animateRotation(svg, targetAngle, onComplete) {
        const startAngle = rotationAngle;
        const duration = 300;
        const startTime = performance.now();
        
        function animate(currentTime) {
          const elapsed = currentTime - startTime;
          const progress = Math.min(elapsed / duration, 1);
          // Easing function (ease-out with slight bounce for "click" feeling)
          const eased = 1 - Math.pow(1 - progress, 3);
          
          rotationAngle = startAngle + (targetAngle - startAngle) * eased;
          applyRotation(svg, rotationAngle);
          
          if (progress < 1) {
            requestAnimationFrame(animate);
          } else {
            rotationAngle = targetAngle;
            if (onComplete) onComplete();
          }
        }
        requestAnimationFrame(animate);
      }
    })();
  </script>
</main>


    </main>
    <footer class="site-footer">
  <div class="container text-center muted small" style="padding: 16px 0;">
    <p>&copy; 2025 ミセサポ</p>
  </div>
</footer>


    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="/js/firebase-config.js"></script>
    <script src="/js/role_config.js"></script>
    <script src="/js/users.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/navigation.js"></script>
    <script src="/modal_manager.js"></script>
    <script src="/app.js"></script>
    <script>
      // ログイン画面では通常ヘッダーを表示
      (function() {
        const path = window.location.pathname || '';
        const isSigninPage = path.includes('/signin.html') || path.includes('/signin');
        
        // ログイン画面では通常ヘッダーを表示、デフォルトヘッダーを非表示
        if (isSigninPage) {
          const defaultHeaderWrapper = document.getElementById('default-header-wrapper');
          const normalHeaderWrapper = document.getElementById('normal-header-wrapper');
          if (defaultHeaderWrapper) {
            defaultHeaderWrapper.style.display = 'none';
          }
          if (normalHeaderWrapper) {
            normalHeaderWrapper.style.display = 'block';
            // ログイン画面では通常ヘッダーを常に表示
            const normalHeader = normalHeaderWrapper.querySelector('.normal-header');
            if (normalHeader) {
              normalHeader.classList.add('visible');
            }
          }
        }
      })();
    </script>
  </body>
  </html>


